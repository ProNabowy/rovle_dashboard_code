import{C as W,O as w,r as o,b as de,c as fe,e as F,m as N,M as pe,N as me,Q as be,V as ve,W as K,X as ye,j as d,J as he,n as ge,u as xe,A as Pe,l as Ce,G as Se,U as Te,S as Ne,I as je}from"./index-oURgFu_2.js";function B(r,e){(e==null||e>r.length)&&(e=r.length);for(var a=0,t=new Array(e);a<e;a++)t[a]=r[a];return t}function Ie(r){if(Array.isArray(r))return B(r)}function Oe(r){if(typeof Symbol<"u"&&r[Symbol.iterator]!=null||r["@@iterator"]!=null)return Array.from(r)}function X(r,e){if(r){if(typeof r=="string")return B(r,e);var a=Object.prototype.toString.call(r).slice(8,-1);if(a==="Object"&&r.constructor&&(a=r.constructor.name),a==="Map"||a==="Set")return Array.from(r);if(a==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return B(r,e)}}function _e(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Ee(r){return Ie(r)||Oe(r)||X(r)||_e()}function R(r){"@babel/helpers - typeof";return R=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},R(r)}function Ae(r,e){if(R(r)!=="object"||r===null)return r;var a=r[Symbol.toPrimitive];if(a!==void 0){var t=a.call(r,e||"default");if(R(t)!=="object")return t;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}function we(r){var e=Ae(r,"string");return R(e)==="symbol"?e:String(e)}function Re(r,e,a){return e=we(e),e in r?Object.defineProperty(r,e,{value:a,enumerable:!0,configurable:!0,writable:!0}):r[e]=a,r}function Ve(r){if(Array.isArray(r))return r}function Fe(r,e){var a=r==null?null:typeof Symbol<"u"&&r[Symbol.iterator]||r["@@iterator"];if(a!=null){var t,n,p,u,g=[],m=!0,j=!1;try{if(p=(a=a.call(r)).next,e===0){if(Object(a)!==a)return;m=!1}else for(;!(m=(t=p.call(a)).done)&&(g.push(t.value),g.length!==e);m=!0);}catch(y){j=!0,n=y}finally{try{if(!m&&a.return!=null&&(u=a.return(),Object(u)!==u))return}finally{if(j)throw n}}return g}}function De(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function G(r,e){return Ve(r)||Fe(r,e)||X(r,e)||De()}var M=W.extend({defaultProps:{__TYPE:"Accordion",id:null,activeIndex:null,className:null,style:null,multiple:!1,expandIcon:null,collapseIcon:null,transitionOptions:null,onTabOpen:null,onTabClose:null,onTabChange:null,children:void 0}}),_=W.extend({defaultProps:{__TYPE:"AccordionTab",className:null,contentClassName:null,contentStyle:null,disabled:!1,header:null,headerClassName:null,headerStyle:null,headerTemplate:null,style:null,tabIndex:0,children:void 0},getCProp:function(e,a){return w.getComponentProp(e,a,_.defaultProps)},getCProps:function(e){return w.getComponentProps(e,_.defaultProps)},getCOtherProps:function(e){return w.getComponentDiffProps(e,_.defaultProps)}});function J(r,e){var a=Object.keys(r);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(r);e&&(t=t.filter(function(n){return Object.getOwnPropertyDescriptor(r,n).enumerable})),a.push.apply(a,t)}return a}function O(r){for(var e=1;e<arguments.length;e++){var a=arguments[e]!=null?arguments[e]:{};e%2?J(Object(a),!0).forEach(function(t){Re(r,t,a[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(a)):J(Object(a)).forEach(function(t){Object.defineProperty(r,t,Object.getOwnPropertyDescriptor(a,t))})}return r}var q=function(){},Y=o.forwardRef(function(r,e){var a=o.useContext(de),t=M.getProps(r,a),n=o.useState(t.id),p=G(n,2),u=p[0],g=p[1],m=o.useState(t.activeIndex),j=G(m,2),y=j[0],D=j[1],V=o.useRef(null),E=t.onTabChange?t.activeIndex:y,x={props:t,state:{id:u,activeIndex:y}},U=M.setMetaData(O({},x)),P=U.ptm,L=U.ptmo,s=function(l,i){return L(c(l,"pt"),i,{props:l.props,parent:x})},c=function(l,i){return _.getCProp(l,i)},I=function(l,i,f){if(!c(i,"disabled")){var b=A(f),v=null;if(t.multiple){var S=E||[];v=b?S.filter(function(T){return T!==f}):[].concat(Ee(S),[f])}else v=b?null:f;var h=b?t.onTabClose:t.onTabOpen;h&&h({originalEvent:l,index:f}),t.onTabChange?t.onTabChange({originalEvent:l,index:v}):D(v)}l.preventDefault()},A=function(l){return t.multiple?E&&E.some(function(i){return i===l}):E===l};if(o.useImperativeHandle(e,function(){return{props:t,getElement:function(){return V.current}}}),fe(function(){u||g(pe())}),!u)return null;var z=function(l,i,f){var b=O(O({},c(l,"style")||{}),c(l,"headerStyle")||{}),v=F("p-accordion-header",{"p-highlight":i,"p-disabled":c(l,"disabled")},c(l,"headerClassName"),c(l,"className")),S=u+"_header_"+f,h=u+"_content_"+f,T=c(l,"disabled")?-1:c(l,"tabIndex"),H=N({className:"p-accordion-header-text"},s(l,"headertitle")),k=c(l,"headerTemplate")?w.getJSXElement(c(l,"headerTemplate"),_.getCProps(l)):o.createElement("span",H,c(l,"header")),ne="p-accordion-toggle-icon",$=N({className:ne},s(l,"headericon")),le=i?t.collapseIcon||o.createElement(me,$):t.expandIcon||o.createElement(be,$),se=ve.getJSXIcon(le,O({},$),{props:t,selected:i}),ce=i?K("collapseLabel"):K("expandLabel"),oe=N({className:v,style:b},s(l,"header")),ue=N({id:S,href:"#"+h,className:"p-accordion-header-link",role:"tab",tabIndex:T,onClick:function(ie){return I(ie,l,f)},"aria-label":ce,"aria-controls":h,"aria-expanded":i},s(l,"headeraction"));return o.createElement("div",oe,o.createElement("a",ue,se,k))},Q=function(l,i,f){var b=O(O({},c(l,"style")||{}),c(l,"contentStyle")||{}),v=F("p-toggleable-content",c(l,"contentClassName"),c(l,"className")),S=u+"_content_"+f,h=u+"_header_"+f,T=o.createRef(),H=N({id:S,ref:T,className:v,style:b,role:"region","aria-labelledby":h},s(l,"toggleablecontent")),k=N({className:"p-accordion-content"},s(l,"content"));return o.createElement(ye,{nodeRef:T,classNames:"p-toggleable-content",timeout:{enter:1e3,exit:450},in:i,unmountOnExit:!0,options:t.transitionOptions},o.createElement("div",H,o.createElement("div",k,c(l,"children"))))},Z=function(l,i){if(w.isValidChild(l,"AccordionTab")){var f=u+"_"+i,b=A(i),v=z(l,b,i),S=Q(l,b,i),h=F("p-accordion-tab",{"p-accordion-tab-active":b}),T=N({key:f,className:h},_.getCOtherProps(l),s(l,"root"));return o.createElement("div",T,v,S)}return null},ee=function(){return o.Children.map(t.children,Z)},re=F("p-accordion p-component",t.className),ae=ee(),te=N({id:u,ref:V,className:re,style:t.style},M.getOtherProps(t),P("root"));return o.createElement("div",te,ae)});q.displayName="AccordionTab";Y.displayName="Accordion";function Ue({items:r,options:e,formik:a,onOptionChange:t}){return o.useEffect(()=>(e!=null&&e.includes(466)&&!e.includes(517)&&a.setFieldValue("permissions",[...e,517]),e!=null&&e.includes(467)&&!e.includes(518)&&a.setFieldValue("permissions",[...e,518]),e!=null&&e.includes(469)&&!e.includes(520)&&a.setFieldValue("permissions",[...e,520]),!(e!=null&&e.includes(466))&&e.includes(517)&&a.setFieldValue("permissions",e==null?void 0:e.filter(n=>n!=517)),!(e!=null&&e.includes(467))&&e.includes(518)&&a.setFieldValue("permissions",e==null?void 0:e.filter(n=>n!=518)),!(e!=null&&e.includes(469))&&e.includes(520)&&a.setFieldValue("permissions",e==null?void 0:e.filter(n=>n!=520)),()=>{}),[e]),d.jsx("div",{className:"card flex flex-wrap justify-content-center gap-3 sm:gap-10",children:r==null?void 0:r.map((n,p)=>d.jsxs("div",{className:"flex items-center",children:[d.jsx(he,{disabled:(n==null?void 0:n.id)===517||(n==null?void 0:n.id)===518||(n==null?void 0:n.id)===520,inputId:n==null?void 0:n.id,name:n==null?void 0:n.id,value:n==null?void 0:n.title,onChange:u=>t(u,n),checked:e==null?void 0:e.includes(n==null?void 0:n.id)}),d.jsx("label",{htmlFor:n==null?void 0:n.id,className:"ms-2 !mb-0 cursor-pointer select-none",children:n==null?void 0:n.title})]},p))})}function Le({optionKey:r,permissions:e,options:a,formik:t,onOptionChange:n}){return d.jsxs("div",{className:"col-span-6 flex items-center flex-wrap",children:[d.jsx("label",{className:"text-[#252525] text-[20px] me-5 sm:me-0 sm:min-w-[200px]",children:r}),d.jsx(Ue,{onOptionChange:n,options:a,formik:t,items:e[r]})]})}const He=r=>{const[e,a]=o.useState([]),t=new Te,n=new Se,p=new Ne,u=Object.keys(e),m=ge().search.slice(4),j=xe(),[y,D]=o.useState([]),[V,E]=o.useState({name:"",permissions:[]}),{setIsLoading:x}=o.useContext(Pe),P=Ce({initialValues:V,onSubmit:s=>(x(!0),r?t.updateRole(m,s).finally(c=>x(!1)):p.addRole(s,j).finally(c=>x(!1)))});o.useEffect(()=>(P.setValues({name:"",permissions:[]}),()=>{}),[]);const L=(s,c)=>{var A;let I=[...(A=P.values)==null?void 0:A.permissions];s.checked?I.push(c==null?void 0:c.id):I.splice(I.indexOf(c==null?void 0:c.id),1),P.setFieldValue("permissions",I)};return o.useEffect(()=>(x(!0),n.getPermissions().then(s=>a(s)).finally(s=>x(!1)),r&&n.getSingleRole(m).then(s=>{D((s==null?void 0:s.permissions)||[]),P.setFieldValue("name",s==null?void 0:s.name)}),()=>{}),[]),o.useEffect(()=>{P.setFieldValue("permissions",y==null?void 0:y.map(s=>s==null?void 0:s.id))},[y]),{permissionsKeys:u,onOptionChange:L,permissions:e,formik:P}};function Me({asEdit:r}){var p;const{permissionsKeys:e,permissions:a,formik:t,onOptionChange:n}=He(r);return d.jsxs("form",{onSubmit:t.handleSubmit,autoComplete:"off",className:"permission-form",children:[d.jsxs("div",{className:"p-3 sm:p-10 pb-2",children:[d.jsx("label",{htmlFor:"name-input",className:"mb-3 block text-[20px] text-[#234486]",children:"Nombre del Rol"}),d.jsx(je,{type:"text",required:!0,name:"name",value:(p=t==null?void 0:t.values)==null?void 0:p.name,onChange:t.handleChange,placeholder:"Ingresar Nombre del Rol"})]}),d.jsx("label",{className:"block text-[24px] text-[#252525] opacity-70 p-3 sm:p-10 pb-2",children:"PÃ¡ginas"}),d.jsx(Y,{multiple:!0,className:"p-3 sm:p-10",activeIndex:0,children:e.map((u,g)=>{var m;return d.jsx(q,{header:u,children:d.jsx(Le,{options:(m=t.values)==null?void 0:m.permissions,onOptionChange:n,optionKey:u,formik:t,permissions:a})},g)})}),d.jsx("div",{className:"flex-end-container",children:d.jsx("button",{type:"submit",className:"min-btn",children:"Actualizar"})})]})}export{Me as P};
