import{b as q,O as R,r as s,c as de,W as fe,d as U,m as N,X as pe,Y as me,Z as be,_ as ve,$ as W,a0 as he,j as d,Q as ye,i as ge,u as xe,A as Pe,h as Se,G as Ce,U as Te,S as Ne,I as je}from"./index-ucQm_BBe.js";function M(r,e){(e==null||e>r.length)&&(e=r.length);for(var a=0,t=new Array(e);a<e;a++)t[a]=r[a];return t}function Ie(r){if(Array.isArray(r))return M(r)}function _e(r){if(typeof Symbol<"u"&&r[Symbol.iterator]!=null||r["@@iterator"]!=null)return Array.from(r)}function J(r,e){if(r){if(typeof r=="string")return M(r,e);var a=Object.prototype.toString.call(r).slice(8,-1);if(a==="Object"&&r.constructor&&(a=r.constructor.name),a==="Map"||a==="Set")return Array.from(r);if(a==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return M(r,e)}}function Oe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Ee(r){return Ie(r)||_e(r)||J(r)||Oe()}function F(r){"@babel/helpers - typeof";return F=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},F(r)}function Ae(r,e){if(F(r)!=="object"||r===null)return r;var a=r[Symbol.toPrimitive];if(a!==void 0){var t=a.call(r,e||"default");if(F(t)!=="object")return t;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}function we(r){var e=Ae(r,"string");return F(e)==="symbol"?e:String(e)}function Re(r,e,a){return e=we(e),e in r?Object.defineProperty(r,e,{value:a,enumerable:!0,configurable:!0,writable:!0}):r[e]=a,r}function Fe(r){if(Array.isArray(r))return r}function Ve(r,e){var a=r==null?null:typeof Symbol<"u"&&r[Symbol.iterator]||r["@@iterator"];if(a!=null){var t,f,n,o,b=[],y=!0,x=!1;try{if(n=(a=a.call(r)).next,e===0){if(Object(a)!==a)return;y=!1}else for(;!(y=(t=n.call(a)).done)&&(b.push(t.value),b.length!==e);y=!0);}catch(j){x=!0,f=j}finally{try{if(!y&&a.return!=null&&(o=a.return(),Object(o)!==o))return}finally{if(x)throw f}}return b}}function De(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function X(r,e){return Fe(r)||Ve(r,e)||J(r,e)||De()}var K=q.extend({defaultProps:{__TYPE:"Accordion",id:null,activeIndex:null,className:null,style:null,multiple:!1,expandIcon:null,collapseIcon:null,transitionOptions:null,onTabOpen:null,onTabClose:null,onTabChange:null,children:void 0}}),w=q.extend({defaultProps:{__TYPE:"AccordionTab",className:null,contentClassName:null,contentStyle:null,disabled:!1,header:null,headerClassName:null,headerStyle:null,headerTemplate:null,style:null,tabIndex:0,children:void 0},getCProp:function(e,a){return R.getComponentProp(e,a,w.defaultProps)},getCProps:function(e){return R.getComponentProps(e,w.defaultProps)},getCOtherProps:function(e){return R.getComponentDiffProps(e,w.defaultProps)}});function Y(r,e){var a=Object.keys(r);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(r);e&&(t=t.filter(function(f){return Object.getOwnPropertyDescriptor(r,f).enumerable})),a.push.apply(a,t)}return a}function A(r){for(var e=1;e<arguments.length;e++){var a=arguments[e]!=null?arguments[e]:{};e%2?Y(Object(a),!0).forEach(function(t){Re(r,t,a[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(a)):Y(Object(a)).forEach(function(t){Object.defineProperty(r,t,Object.getOwnPropertyDescriptor(a,t))})}return r}var z=function(){},Q=s.forwardRef(function(r,e){var a=s.useContext(de),t=K.getProps(r,a),f=s.useState(t.id),n=X(f,2),o=n[0],b=n[1],y=s.useState(t.activeIndex),x=X(y,2),j=x[0],L=x[1],I=s.useRef(null),O=t.onTabChange?t.activeIndex:j,V={props:t,state:{id:o,activeIndex:j}},$=K.setMetaData(A({},V)),_=$.ptm,G=$.ptmo,p=function(l,i){return G(u(l,"pt"),i,{props:l.props,parent:V})},u=function(l,i){return w.getCProp(l,i)},c=function(l,i,m){if(!u(i,"disabled")){var h=v(m),g=null;if(t.multiple){var C=O||[];g=h?C.filter(function(T){return T!==m}):[].concat(Ee(C),[m])}else g=h?null:m;var P=h?t.onTabClose:t.onTabOpen;P&&P({originalEvent:l,index:m}),t.onTabChange?t.onTabChange({originalEvent:l,index:g}):L(g)}l.preventDefault()},v=function(l){return t.multiple?O&&O.some(function(i){return i===l}):O===l};if(s.useImperativeHandle(e,function(){return{props:t,getElement:function(){return I.current}}}),fe(function(){o||b(pe())}),!o)return null;var E=function(l,i,m){var h=A(A({},u(l,"style")||{}),u(l,"headerStyle")||{}),g=U("p-accordion-header",{"p-highlight":i,"p-disabled":u(l,"disabled")},u(l,"headerClassName"),u(l,"className")),C=o+"_header_"+m,P=o+"_content_"+m,T=u(l,"disabled")?-1:u(l,"tabIndex"),H=N({className:"p-accordion-header-text"},p(l,"headertitle")),k=u(l,"headerTemplate")?R.getJSXElement(u(l,"headerTemplate"),w.getCProps(l)):s.createElement("span",H,u(l,"header")),ne="p-accordion-toggle-icon",B=N({className:ne},p(l,"headericon")),le=i?t.collapseIcon||s.createElement(me,B):t.expandIcon||s.createElement(be,B),se=ve.getJSXIcon(le,A({},B),{props:t,selected:i}),ce=i?W("collapseLabel"):W("expandLabel"),oe=N({className:g,style:h},p(l,"header")),ie=N({id:C,href:"#"+P,className:"p-accordion-header-link",role:"tab",tabIndex:T,onClick:function(ue){return c(ue,l,m)},"aria-label":ce,"aria-controls":P,"aria-expanded":i},p(l,"headeraction"));return s.createElement("div",oe,s.createElement("a",ie,se,k))},D=function(l,i,m){var h=A(A({},u(l,"style")||{}),u(l,"contentStyle")||{}),g=U("p-toggleable-content",u(l,"contentClassName"),u(l,"className")),C=o+"_content_"+m,P=o+"_header_"+m,T=s.createRef(),H=N({id:C,ref:T,className:g,style:h,role:"region","aria-labelledby":P},p(l,"toggleablecontent")),k=N({className:"p-accordion-content"},p(l,"content"));return s.createElement(he,{nodeRef:T,classNames:"p-toggleable-content",timeout:{enter:1e3,exit:450},in:i,unmountOnExit:!0,options:t.transitionOptions},s.createElement("div",H,s.createElement("div",k,u(l,"children"))))},Z=function(l,i){if(R.isValidChild(l,"AccordionTab")){var m=o+"_"+i,h=v(i),g=E(l,h,i),C=D(l,h,i),P=U("p-accordion-tab",{"p-accordion-tab-active":h}),T=N({key:m,className:P},w.getCOtherProps(l),p(l,"root"));return s.createElement("div",T,g,C)}return null},ee=function(){return s.Children.map(t.children,Z)},re=U("p-accordion p-component",t.className),ae=ee(),te=N({id:o,ref:I,className:re,style:t.style},K.getOtherProps(t),_("root"));return s.createElement("div",te,ae)});z.displayName="AccordionTab";Q.displayName="Accordion";function Ue({items:r,options:e,formik:a,onOptionChange:t,isDisabled:f}){return s.useEffect(()=>(e!=null&&e.includes(466)&&!e.includes(517)&&a.setFieldValue("permissions",[...e,517]),e!=null&&e.includes(467)&&!e.includes(518)&&a.setFieldValue("permissions",[...e,518]),e!=null&&e.includes(469)&&!e.includes(520)&&a.setFieldValue("permissions",[...e,520]),!(e!=null&&e.includes(466))&&e.includes(517)&&a.setFieldValue("permissions",e==null?void 0:e.filter(n=>n!=517)),!(e!=null&&e.includes(467))&&e.includes(518)&&a.setFieldValue("permissions",e==null?void 0:e.filter(n=>n!=518)),!(e!=null&&e.includes(469))&&e.includes(520)&&a.setFieldValue("permissions",e==null?void 0:e.filter(n=>n!=520)),()=>{}),[e]),d.jsx("div",{className:"card flex flex-wrap justify-content-center gap-3 sm:gap-10",children:r==null?void 0:r.map((n,o)=>d.jsxs("div",{className:"flex items-center w-fit",children:[d.jsx(ye,{disabled:(n==null?void 0:n.id)===517||(n==null?void 0:n.id)===518||(n==null?void 0:n.id)===520||f,inputId:n==null?void 0:n.id,name:n==null?void 0:n.id,value:n==null?void 0:n.title,onChange:b=>t(b,n),checked:e==null?void 0:e.includes(n==null?void 0:n.id)}),d.jsx("label",{htmlFor:n==null?void 0:n.id,className:`ms-2 !mb-0 select-none text-[14px] min-w-[50px] sm:text-base ${f?"cursor-not-allowed":"cursor-pointer"}`,children:n==null?void 0:n.title})]},o))})}function Le({optionKey:r,permissions:e,options:a,formik:t,onOptionChange:f,isDisabled:n}){return d.jsxs("div",{className:"col-span-6 flex items-center flex-wrap",children:[d.jsx("label",{className:"text-[#252525] text-[20px] me-5 sm:me-0 sm:min-w-[200px]",children:r}),d.jsx(Ue,{onOptionChange:f,options:a,isDisabled:n,formik:t,items:e[r]})]})}const $e=r=>{const[e,a]=s.useState([]),t=new Te,f=new Ce,n=new Ne,[o,b]=s.useState(!1),y=Object.keys(e),j=ge().search.slice(4),L=xe(),[I,O]=s.useState([]),[V,$]=s.useState({name:"",permissions:[]}),{setIsLoading:_}=s.useContext(Pe),p=Se({initialValues:V,onSubmit:c=>(_(!0),r?t.updateRole(j,c).finally(v=>_(!1)):n.addRole(c,L).finally(v=>_(!1)))});s.useEffect(()=>(p.setValues({name:"",permissions:[]}),()=>{}),[]);const u=(c,v)=>{var D;let E=[...(D=p.values)==null?void 0:D.permissions];c.checked?E.push(v==null?void 0:v.id):E.splice(E.indexOf(v==null?void 0:v.id),1),p.setFieldValue("permissions",E)};return s.useEffect(()=>(_(!0),f.getPermissions().then(c=>a(c)).finally(c=>_(!1)),r&&f.getSingleRole(j).then(c=>{b(!(c!=null&&c.owner_id)),O((c==null?void 0:c.permissions)||[]),p.setFieldValue("name",c==null?void 0:c.name)}),()=>{}),[]),s.useEffect(()=>{p.setFieldValue("permissions",I==null?void 0:I.map(c=>c==null?void 0:c.id))},[I]),{permissionsKeys:y,onOptionChange:u,permissions:e,formik:p,isDisabled:o}};function Be({asEdit:r}){var o;const{permissionsKeys:e,permissions:a,formik:t,onOptionChange:f,isDisabled:n}=$e(r);return d.jsxs("form",{onSubmit:t.handleSubmit,autoComplete:"off",className:"permission-form",children:[d.jsxs("div",{className:"p-3 sm:p-10 pb-2",children:[d.jsx("label",{htmlFor:"name-input",className:"mb-3 block text-base sm:text-[20px] text-[#234486]",children:"Nombre del Rol"}),d.jsx(je,{type:"text",required:!0,name:"name",value:(o=t==null?void 0:t.values)==null?void 0:o.name,onChange:t.handleChange,placeholder:"Ingresar Nombre del Rol"})]}),d.jsx("label",{className:"block text-[24px] text-[#252525] opacity-70 p-3 sm:p-10 pb-2",children:"PÃ¡ginas"}),d.jsx(Q,{multiple:!0,className:"p-3 sm:p-10",activeIndex:0,children:e.map((b,y)=>{var x;return d.jsx(z,{header:b,children:d.jsx(Le,{options:(x=t.values)==null?void 0:x.permissions,onOptionChange:f,optionKey:b,formik:t,permissions:a,isDisabled:n})},y)})}),n?null:d.jsx("div",{className:"flex-end",children:d.jsx("button",{type:"submit",className:"min-btn",children:"Actualizar"})})]})}export{Be as P};
