import{r as l,p as R,h as _,j as a,F as T,z as B,X as A,A as K,n as L,G as Q,D as U,Y as z,y as $}from"./index-T_rrs4rL.js";import{I as F}from"./InputsGroup-3Y_BKlWt.js";const X=(e,p,u)=>{const c=l.useRef(),n=l.useRef(),r=l.useRef(),[d,g]=l.useState(0),m=R(p,"id",u),[o,s]=l.useState({weight:"",price:"",id:"",provider_id:u});return{inputWeightRef:c,inputQuntiyRef:r,setAddNewPackage:s,inputPriceRef:n,handelAddNewPackage:()=>{var h,t,b,x,w;!c.current.value||!n.current.value?_.warning("warning","Please Fill The Reqriure Inputs"):((t=(h=e==null?void 0:e.values)==null?void 0:h.presentations)==null?void 0:t.some(v=>parseInt(v.weight)===parseInt(o.weight)&&parseInt(v.price)===parseInt(o.price)))?_.warning("warning","Please Don't Add Duplicate Package"):m!=null&&m.manage_stock&&!((b=r.current)!=null&&b.value)?_.warning("warning","Please fill out Quantity Field"):(o.id=d,e.setFieldValue("presentations",[...(x=e==null?void 0:e.values)==null?void 0:x.presentations,{...o,provider_id:u}]),g(v=>v+1),c.current.value="",n.current.value="",(w=r.current)!=null&&w.value&&(r.current.value=""),_.success("success","Package Add Successfully"))},removePackage:h=>{var t,b;return(b=(t=e==null?void 0:e.values)==null?void 0:t.presentations)==null?void 0:b.filter(x=>+x.id!=+h)},roasters:p}};function Y({formik:e,removePackage:p}){var u,c;return a.jsx("div",{className:"col-span-6",children:a.jsx("div",{className:"border border-[#252525] p-[32px] rounded-[20px] h-full max-h-[270px] overflow-y-auto add-package",children:(c=(u=e==null?void 0:e.values)==null?void 0:u.presentations)==null?void 0:c.map((n,r)=>a.jsxs("div",{id:n.id,className:"flex items-center justify-between p-3 rounded-[5px] border border-[#252525] mb-5",children:[a.jsxs("p",{className:"font-medium text-[#252525]",children:[n.price," Euro por ",n.weight," gm"]}),a.jsx(T,{icon:B,onClick:d=>e.setFieldValue("presentations",p(n.id)),className:"text-[#252525] text-[20px] cursor-pointer"})]},r))})})}function H({formik:e,roasters:p,provider_id:u}){var o;const{inputWeightRef:c,inputQuntiyRef:n,setAddNewPackage:r,inputPriceRef:d,handelAddNewPackage:g,removePackage:m}=X(e,p,u);return a.jsxs("div",{className:"rounded-[20px] mt-20 border border-[#252525] p-[32px] grid grid-cols-12 gap-10",children:[a.jsxs("form",{onSubmit:s=>s.preventDefault(),className:"col-span-6",children:[a.jsxs("div",{className:"mb-8",children:[a.jsx("label",{htmlFor:"Weight /gm",className:"text-[18px] text-[#252525] font-medium",children:"Peso"}),a.jsx(A,{type:"number",ref:c,placeholder:"Ingresar Peso /gr",onChange:s=>r(i=>({...i,weight:s.target.value})),id:"Weight /gm"})]}),a.jsxs("div",{className:"mb-8",children:[a.jsx("label",{htmlFor:"PriceEuro",className:"text-[18px] text-[#252525] font-medium",children:"Precio"}),a.jsx(A,{type:"number",ref:d,placeholder:"Ingresar Precio /Euro",onChange:s=>r(i=>({...i,price:s.target.value})),id:"PriceEuro"})]}),(o=R(p,"id",u))!=null&&o.manage_stock?a.jsxs("div",{className:"mb-8",children:[a.jsx("label",{htmlFor:"Units",className:"text-[18px] text-[#252525] font-medium",children:"Cantidad"}),a.jsx(A,{type:"number",ref:n,placeholder:"Cantidad",onChange:s=>r(i=>({...i,units:s.target.value})),id:"Units"})]}):null,a.jsx("button",{type:"button",onClick:g,className:"bg-[#58291E] text-[20px] text-center text-white font-medium w-full py-[16px] px-[24px] rounded-full",children:"Añadir Paquete"})]}),a.jsx(Y,{formik:e,removePackage:m})]})}const J=(e,p,u)=>{var S,E,D,V,q,W,O,G;const c=new Q,[n,r]=l.useState([]),[d,g]=l.useState({}),[m,o]=l.useState([]),[s,i]=l.useState({}),{setIsLoading:y,user:h}=l.useContext(K),t=h==null?void 0:h.provider,[b,x]=l.useState([]);l.useEffect(()=>{y(!0),c.getRoasters().then(C=>r(C)).finally(C=>y(!1))},[]),l.useEffect(()=>{var C;if((C=e.values)!=null&&C.provider_id){const j=n==null?void 0:n.filter(I=>{var N;return I.id==((N=e.values)==null?void 0:N.provider_id)});i(j==null?void 0:j[0])}t&&!(d!=null&&d.provider_id)?(o(t),i(t),x(t==null?void 0:t.coffee_shops),e.setFieldValue("provider_id",t==null?void 0:t.id)):o(n)},[n]);const P=L().search.slice(-4)==="true";l.useEffect(()=>{x(s==null?void 0:s.coffee_shops),e.setFieldValue("provider_id",s==null?void 0:s.id)},[s]),l.useEffect(()=>(e.setFieldValue("origins",p),()=>{}),[p]),l.useEffect(()=>(e.setFieldValue("presentations",u),()=>{}),[u]);const v=[{names:["Nombre del Producto","Código"],placeholders:["Este será el nombre que aparecerá en el listado en el shop.","Ingresar Código"],values:[(S=e==null?void 0:e.values)==null?void 0:S.commercial_name,(E=e.values)==null?void 0:E.code],nameAttr:["commercial_name","code"],onChange:e.handleChange,required:[!0,!0],key:["commercial_name","code"]},{names:["Nombre Comercial","Region"],placeholders:["Ingresar Nombre Comercial","Ingresar Region"],key:["commercial_name","region"],required:[!0,!0],values:[(D=e==null?void 0:e.values)==null?void 0:D.commercial_name,(V=e.values)==null?void 0:V.region],nameAttr:["commercial_name","region"],onChange:e.handleChange},{names:["Finca","Puntunaction Sca s"],types:["text","number"],placeholders:["Ingresar Finca","Ingresar Puntunaction Sca s"],key:["farm","sca_score"],values:[(q=e==null?void 0:e.values)==null?void 0:q.farm,(W=e.values)==null?void 0:W.sca_score],nameAttr:["farm","sca_score"],required:[!0,!0],min:[null,80],max:[null,100],onChange:e.handleChange},{names:["Altitud","Proceso"],types:["number","text"],required:[!0,!0],placeholders:["Ingresar Altitud","Ingresar Proceso"],key:["altitude","process"],min:[0,null],max:[8e3,null],values:[(O=e==null?void 0:e.values)==null?void 0:O.altitude,(G=e.values)==null?void 0:G.process],nameAttr:["altitude","process"],onChange:e.handleChange}];return l.useEffect(()=>((d==null?void 0:d.provider_id)&&c.getRoasters().then(j=>{var I;if(r(j),t){const N=(I=j==null?void 0:j.filter(f=>(f==null?void 0:f.id)===(t==null?void 0:t.id)))==null?void 0:I[0];o(N),i(N),x(N==null?void 0:N.coffee_shops)}}),()=>{}),[d]),{inputsData:v,isByNewOWner:P,coffee:b,selectedProvider:s,setSelectedProvider:i,rosters:m,isProvider:t,setAddedShops:g,allRoasters:n,addedShops:d}};function k({formik:e,originsList:p,packagesList:u}){var h,t,b,x,w;const{inputsData:c,coffee:n,isByNewOWner:r,isProvider:d,selectedProvider:g,setSelectedProvider:m,rosters:o,allRoasters:s,setAddedShops:i,addedShops:y}=J(e,p,u);return a.jsxs("form",{onSubmit:e.handleSubmit,className:"px-10 add-product",children:[a.jsxs("div",{className:"flex items-center justify-between mb-8",children:[r?a.jsxs("div",{className:`${d?"w-full":"w-[48%]"}`,children:[a.jsx("label",{htmlFor:"factor",className:"text-[18px] text-[#252525] font-medium",children:"Nombre del proveedor"}),a.jsx("input",{required:!0,value:(h=e==null?void 0:e.values)==null?void 0:h.owner_name,name:"owner_name",type:"text",onChange:e.handleChange,id:"factor",className:"p-3 w-full border-b border-b-[#b3b3b3] placeholder:text-[#b3b3b3]",placeholder:"Enter factor name"})]}):null,d?null:a.jsxs("div",{className:`w-[48%] ${r?"":"flex-1"}`,children:[a.jsx("label",{htmlFor:"owner",className:"text-[18px] text-[#252525] font-medium",children:"Roaster To"}),a.jsx(U,{value:g,onChange:P=>{var v;return m(R(o,"id",(v=P.target.value)==null?void 0:v.id))},options:o,optionLabel:"commercial_name",inputId:"owner",filter:!0,placeholder:"Seleccionar Tostador",className:"w-full p-2  !shadow-none !rounded-none border-[#b3b3b3] !border-t-transparent !border-l-transparent !border-r-transparent"})]})]}),a.jsx(F,{data:c[0]}),a.jsx(z,{classNames:"!w-full mb-8",formik:e,provider_id:(t=e.values)==null?void 0:t.provider_id}),a.jsxs("div",{className:"mb-8",children:[a.jsx("label",{htmlFor:"Region",className:"text-[18px] text-[#252525] font-medium",children:"Region"}),a.jsx("input",{value:(b=e==null?void 0:e.values)==null?void 0:b.region,name:"region",type:"text",onChange:e.handleChange,id:"Region",className:"p-3 w-full border-b border-b-[#b3b3b3] placeholder:text-[#b3b3b3]",placeholder:"Ingresar Region"})]}),a.jsx(F,{data:c[2]}),a.jsx(F,{data:c[3]}),a.jsxs("div",{className:"mb-8",children:[a.jsx("label",{htmlFor:"Variedad",className:"text-[18px] text-[#252525] font-medium",children:"Variedad"}),a.jsx("input",{value:(x=e==null?void 0:e.values)==null?void 0:x.grades,name:"grades",type:"text",onChange:e.handleChange,id:"Variedad",className:"p-3 w-full border-b border-b-[#b3b3b3] placeholder:text-[#b3b3b3]",placeholder:"Ingresar Variedad"})]}),a.jsx($,{formik:e,dataKey:"coffeeShops",url:"/setups/coffee-shop/add-coffee",title:"Tiendas",pageKey:"Coffee Shops",pagePermissionKeyName:"dashboard.coffeeShops.store",options:n,stateList:i,listOfState:y}),a.jsxs("div",{children:[a.jsx("label",{htmlFor:"Description",className:"text-[18px] text-[#252525] font-medium",children:"Descripción"}),a.jsx("textarea",{rows:5,onChange:e.handleChange,type:"text",value:(w=e==null?void 0:e.values)==null?void 0:w.description,name:"description",id:"Description",className:"p-3 w-full border rounded-[5px] mt-5 resize-none border-[#b3b3b3] placeholder:text-[#b3b3b3]",placeholder:"Ingresar Descripción"})]}),a.jsx(H,{formik:e,roasters:s,provider_id:g==null?void 0:g.id}),a.jsx("div",{className:"flex items-center justify-end mt-10",children:a.jsx("button",{type:"submit",className:"bg-[#45B8EA] text-white py-[16px] px-32 rounded-full",children:"Enviar"})})]})}export{k as P};
