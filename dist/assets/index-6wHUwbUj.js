import{r as v,A as V,h as L,G as q,U as S,j as a,I as i,D,n as z,p as B,q as U,P as E,L as R,w as A,F as G,V as K}from"./index-rFxOd0i4.js";const M=()=>{const[e,t]=v.useState({}),u=new q,[m,c]=v.useState([]),h=new S,[x,o]=v.useState(""),{setIsLoading:d,user:n}=v.useContext(V),s=n==null?void 0:n.provider,p=L({initialValues:n,onSubmit:l=>(d(!0),s?(console.log(l.address),h.updateRoaster(s==null?void 0:s.id,l).finally(r=>d(!1))):h.updateProfile(l).finally(r=>d(!1)))}),g=l=>{var r,b,j,_,y,C,F,f,I;return c(l),p.setFieldValue("country_id",(r=l==null?void 0:l[0])==null?void 0:r.id),p.setFieldValue("province_id",(_=(j=(b=l==null?void 0:l[0])==null?void 0:b.provinces)==null?void 0:j[0])==null?void 0:_.id),p.setFieldValue("city_id",(I=(f=(F=(C=(y=l==null?void 0:l[0])==null?void 0:y.provinces)==null?void 0:C[0])==null?void 0:F.cities)==null?void 0:f[0])==null?void 0:I.id),null};return v.useEffect(()=>(d(!0),n!=null&&n.zip?u.getCitiesByZipCode(n==null?void 0:n.zip).then(l=>g(l)).finally(l=>d(!1)):u.getCountries().then(l=>{var r;c(l),p.setFieldValue("country_id",(r=l==null?void 0:l[0])==null?void 0:r.id)}).finally(l=>d(!1)),s?p.setValues({...n,provider_nif:s==null?void 0:s.nif,provider_commercial_name:s==null?void 0:s.commercial_name,provider_official_name:s==null?void 0:s.official_name,provider_address:s==null?void 0:s.address,provider_phone:s==null?void 0:s.phone,provider_zip:s==null?void 0:s.zip}):p.setValues(n),()=>{}),[n]),v.useEffect(()=>(t(n),n!=null&&n.image&&o(""),()=>{}),[n]),{formik:p,data:e,counteris:m,classList:x,setClassList:o,handleBlur:l=>{var r,b,j;return((b=(r=l==null?void 0:l.target)==null?void 0:r.value)==null?void 0:b.length)===5?u.getCitiesByZipCode((j=l==null?void 0:l.target)==null?void 0:j.value).then(_=>g(_)):null},isProvider:s,user:n}};function $({formik:e}){var t,u,m,c,h;return a.jsxs(v.Fragment,{children:[a.jsxs("div",{className:"flex-container",children:[a.jsxs("div",{className:"w-full sm:w-[48%]",children:[a.jsx("label",{htmlFor:"name",className:"label",children:"Nombre"}),a.jsx(i,{value:(t=e==null?void 0:e.values)==null?void 0:t.name,name:"name",type:"text",required:!0,onChange:e.handleChange,id:"name",placeholder:"Ingresar Nombre"})]}),a.jsxs("div",{className:"w-full sm:w-[48%]",children:[a.jsx("label",{htmlFor:"email",className:"label",children:"Correo electrónico"}),a.jsx(i,{value:(u=e==null?void 0:e.values)==null?void 0:u.email,name:"email",type:"email",disabled:!0,required:!0,onChange:e.handleChange,id:"email",placeholder:"example@gmail.com"})]})]}),a.jsxs("div",{className:"flex-container",children:[a.jsxs("div",{className:"w-full sm:w-[48%]",children:[a.jsx("label",{htmlFor:"password",className:"label",children:"Contraseña"}),a.jsx(i,{value:(m=e==null?void 0:e.values)==null?void 0:m.password,name:"password",type:"password",required:!0,onChange:e.handleChange,id:"password",defaultValue:"**********",placeholder:"Ingresar Contraseña"})]}),a.jsxs("div",{className:"w-full sm:w-[48%]",children:[a.jsx("label",{htmlFor:"password_confirmation",className:"label",children:"Confirmación de contraseña"}),a.jsx(i,{value:(c=e==null?void 0:e.values)==null?void 0:c.password_confirmation,name:"password_confirmation",type:"password",required:!0,onChange:e.handleChange,id:"password_confirmation",defaultValue:"**********",placeholder:"Ingresar Confirmación de contraseña"})]})]}),a.jsxs("div",{className:"w-full sm:w-[48%]",children:[a.jsx("label",{htmlFor:"Permissions",className:"label block",children:"Permisos"}),a.jsx(i,{disabled:!0,value:e.values.roles&&((h=e.values.roles[0])==null?void 0:h.name),type:"text",id:"Permissions"})]})]})}function H({formik:e,counteris:t,handleBlur:u}){var m,c,h,x,o,d,n,s,w,p,g,N;return a.jsxs(v.Fragment,{children:[a.jsxs("div",{className:"flex-container",children:[a.jsxs("div",{className:"w-full sm:w-[48%]",children:[a.jsx("label",{htmlFor:"email",className:"label",children:"Correo electrónico"}),a.jsx(i,{value:(m=e==null?void 0:e.values)==null?void 0:m.email,name:"email",type:"email",disabled:!0,required:!0,onChange:e.handleChange,id:"email",placeholder:"example@gmail.com"})]}),a.jsxs("div",{className:"w-full sm:w-[48%]",children:[a.jsx("label",{htmlFor:"password",className:"label",children:"Contraseña"}),a.jsx(i,{value:(c=e==null?void 0:e.values)==null?void 0:c.user_password,name:"user_password",type:"password",required:!0,onChange:e.handleChange,id:"password",defaultValue:"**********",placeholder:"Ingresar Contraseña"})]})]}),a.jsxs("div",{className:"flex-container",children:[a.jsxs("div",{className:"w-full sm:w-[48%]",children:[a.jsx("label",{htmlFor:"provider_nif",className:"label",children:"NIF"}),a.jsx(i,{value:(h=e==null?void 0:e.values)==null?void 0:h.provider_nif,name:"provider_nif",type:"text",required:!0,onChange:e.handleChange,id:"provider_nif",placeholder:"Ingresar NIF"})]}),a.jsxs("div",{className:"w-full sm:w-[48%]",children:[a.jsx("label",{htmlFor:"provider_commercial_name",className:"label",children:"Nombre comercial"}),a.jsx(i,{value:(x=e==null?void 0:e.values)==null?void 0:x.provider_commercial_name,name:"provider_commercial_name",type:"text",required:!0,onChange:e.handleChange,id:"provider_commercial_name",placeholder:"Ingresar nombre comercial"})]})]}),a.jsxs("div",{className:"flex-container",children:[a.jsxs("div",{className:"w-full sm:w-[48%]",children:[a.jsx("label",{htmlFor:"provider_official_name",className:"label",children:"Nombre oficial"}),a.jsx(i,{value:(o=e==null?void 0:e.values)==null?void 0:o.provider_official_name,name:"provider_official_name",type:"text",required:!0,onChange:e.handleChange,id:"provider_official_name",placeholder:"Ingresar nombre oficial"})]}),a.jsxs("div",{className:"w-full sm:w-[48%]",children:[a.jsx("label",{htmlFor:"address",className:"label",children:"Dirección"}),a.jsx(i,{value:(d=e==null?void 0:e.values)==null?void 0:d.provider_address,name:"provider_address",type:"text",required:!0,onChange:e.handleChange,id:"address",placeholder:"Ingresar dirección"})]})]}),a.jsxs("div",{className:"flex-container",children:[a.jsxs("div",{className:"w-full sm:w-[48%]",children:[a.jsx("label",{htmlFor:"zip",className:"label",children:"Código postal"}),a.jsx(i,{value:(n=e==null?void 0:e.values)==null?void 0:n.provider_zip,name:"provider_zip",onBlur:u,type:"text",required:!0,min:5,max:5,maxLength:5,minLength:5,onChange:e.handleChange,id:"zip",placeholder:"Ingresar código postal"})]}),a.jsxs("div",{className:"w-full sm:w-[48%]",children:[a.jsx("label",{htmlFor:"phone",className:"label",children:"Teléfono"}),a.jsx(i,{value:(s=e==null?void 0:e.values)==null?void 0:s.provider_phone,name:"provider_phone",type:"text",required:!0,onChange:e.handleChange,id:"phone",placeholder:"Ingresar teléfono"})]})]}),a.jsxs("div",{className:"flex items-center justify-between flex-wrap gap-3 mb-8",children:[a.jsxs("div",{className:"w-full sm:w-[48%]",children:[a.jsx("label",{className:"text-[18px] text-[#252525] font-medium block",children:"País"}),a.jsx(D,{value:z(t,"id",(w=e==null?void 0:e.values)==null?void 0:w.country_id),onChange:l=>{var r;return e.setFieldValue("country_id",(r=l.target.value)==null?void 0:r.id)},options:t,optionLabel:"name",filter:!0,emptyFilterMessage:"No hay opciones disponibles",emptyMessage:"No hay opciones disponibles",placeholder:"Seleccionar nombre de país",className:"p-2 w-full !shadow-none !rounded-none !border-t-transparent !border-l-transparent !border-r-transparent"})]}),a.jsx(B,{formik:e,countries:t,country_Key:"country_id",province_Key:"province_id"})]}),a.jsxs("div",{className:"flex items-center justify-between flex-wrap mb-8",children:[a.jsx(U,{formik:e,provinces:(g=z(t,"id",(p=e==null?void 0:e.values)==null?void 0:p.country_id))==null?void 0:g.provinces,province_Key:"province_id",city_Key:"city_id"}),a.jsxs("div",{className:"w-full sm:w-[48%]",children:[a.jsx("label",{htmlFor:"Permissions",className:"label block",children:"Permisos"}),a.jsx(i,{disabled:!0,value:e.values.roles&&((N=e.values.roles[0])==null?void 0:N.name),type:"text",id:"Permissions"})]})]})]})}function Z(){var d,n;const{formik:e,data:t,counteris:u,classList:m,setClassList:c,handleBlur:h,user:x,isProvider:o}=M();return a.jsx(E,{title:"Mi perfil",showActions:!1,titleJsx:o&&!(x!=null&&x.stripe_id)?a.jsx(R,{to:`https://connect.stripe.com/oauth/authorize?response_type=code&client_id=ca_QFDuMB6yCn5mVkylYcoVu9RIeDhzIjLH&scope=read_write&state=${o==null?void 0:o.id}&redirect_uri=https://dashboard.rovle.io/onboardingresult`,target:"_blank",type:"button",className:"min-btn text-center",children:"Haz el onboarding con Stripe"}):null,children:a.jsxs("form",{onSubmit:e.handleSubmit,autoComplete:"off",className:"px-3 sm:px-10",children:[a.jsxs("div",{className:"size-[150px] sm:size-[250px] shadow-lg mb-10 sm:mb-20 m-auto rounded-full flex items-center justify-center relative profile-image overflow-hidden",children:[a.jsx("img",{src:typeof e.values.image=="object"?(d=e.values)!=null&&d.image?URL==null?void 0:URL.createObjectURL((n=e.values)==null?void 0:n.image):`${t==null?void 0:t.image}`:`${t==null?void 0:t.image}`,alt:"",onError:s=>(s.target.src=A,c("!w-[150px] !object-contain"),null),className:`w-full h-full object-cover rounded-full ${m}`}),a.jsxs("div",{className:"size-[150px] sm:size-[250px] flex items-start justify-center rounded-full bg-[#45b9eae1] absolute left-0 z-20 transition bottom-[-150px] sm:bottom-[-250px] uploade-image",children:[a.jsx(i,{type:"file",accept:"image/png, image/gif, image/jpeg",onChange:s=>{e.setFieldValue("image",s.target.files[0]),c("")},id:"uploade-img",classNames:"!w-0 !h-0 appearance-none !opacity-0 !scale-0"}),a.jsx("label",{htmlFor:"uploade-img",children:a.jsx(G,{icon:K,className:"text-[25px] sm:text-[40px] mt-3 sm:mt-8 -ms-6 sm:-ms-3 cursor-pointer text-white"})})]})]}),o?a.jsx(H,{formik:e,handleBlur:h,counteris:u}):a.jsx($,{formik:e}),a.jsx("button",{type:"submit",className:"min-btn block mt-3 ml-auto",children:"Guardar cambios"})]})})}export{Z as default};
