import{r as t,A as L,u as R,h as T,G as D,l as M,S as G,j as e,D as P,n as A,I as p,y as K,P as H}from"./index-rFxOd0i4.js";const U=()=>{let[d,N]=t.useState([]);const u=new D,[S,y]=t.useState({}),s=new G,{setIsLoading:c,user:r}=t.useContext(L),[F,v]=t.useState([]),[_,w]=t.useState([]),b=R(),[x,C]=t.useState({}),[m,g]=t.useState({}),[l,h]=t.useState({}),[O,B]=t.useState({}),[a,E]=t.useState({});t.useEffect(()=>(c(!0),r!=null&&r.provider?u.getAllRoasters().then(n=>N(n)).finally(n=>c(!1)):u.getRoasters().then(n=>N(n)).finally(n=>c(!1)),()=>{}),[]),t.useEffect(()=>{if(r!=null&&r.provider){const n=d==null?void 0:d.filter(i=>{var j;return(i==null?void 0:i.id)!==((j=r==null?void 0:r.provider)==null?void 0:j.id)}),o=d==null?void 0:d.filter(i=>{var j;return(i==null?void 0:i.id)===((j=r==null?void 0:r.provider)==null?void 0:j.id)});v(n),w(o),g(o==null?void 0:o[0])}else v(d),w(d)},[d]),t.useEffect(()=>(l!=null&&l.id&&u.getSingleProduct(l==null?void 0:l.id).then(n=>E(n)),()=>{}),[l]),t.useEffect(()=>{E({})},[x]),t.useEffect(()=>{f.setValues({commercial_name:a==null?void 0:a.commercial_name,code:a==null?void 0:a.code,description:a==null?void 0:a.description,trade_name:a==null?void 0:a.trade_name,region:a==null?void 0:a.region,farm:a==null?void 0:a.farm,sca_score:a==null?void 0:a.sca_score,altitude:a==null?void 0:a.altitude,process:a==null?void 0:a.process,grades:a==null?void 0:a.grades,provider_id:m==null?void 0:m.id,presentations:(a==null?void 0:a.presentations)||[],origins:(a==null?void 0:a.origins)||[],coffeeShops:[],parent_id:x==null?void 0:x.id})},[a]);const V=n=>{const o={...n,product_id:(l==null?void 0:l.id)||(n==null?void 0:n.product_id)};return o.origins=o==null?void 0:o.origins.map(i=>(i==null?void 0:i.id)||i),o.coffeeShops=o==null?void 0:o.coffeeShops.map(i=>(i==null?void 0:i.id)||i),c(!0),s.addProduct(o,b).finally(i=>c(!1))},f=T({initialValues:O}),k=M(n=>V(f.values));return t.useEffect(()=>{m&&f.setFieldValue("provider_id",m==null?void 0:m.id)},[m]),{rosters:d,formik:f,clickHandler:k,selectedProduct:l,setSelectedProduct:h,productInfo:a,selectedProvider:x,currentRoaster:m,setCurrentRoaster:g,setSelectedProvider:C,user:r,roasterFrom:F,roasterTo:_,setAddedShops:y,addedShops:S}};function z(){var m,g;const{rosters:d,formik:N,clickHandler:u,selectedProduct:S,setSelectedProduct:y,productInfo:s,selectedProvider:c,currentRoaster:r,setCurrentRoaster:F,setSelectedProvider:v,roasterFrom:_,roasterTo:w,user:b,setAddedShops:x,addedShops:C}=U();return e.jsxs("form",{onSubmit:l=>l.preventDefault(),autoComplete:"off",className:"px-3 sm:px-10 add-product",children:[e.jsxs("div",{className:"mb-8 flex items-center justify-between flex-wrap gap-3",children:[e.jsxs("div",{className:`${b!=null&&b.provider?"w-full":"w-full sm:w-[48%]"}`,children:[e.jsx("label",{htmlFor:"owner",className:"label",children:"Desde el tostador"}),e.jsx(P,{value:c,filter:!0,emptyFilterMessage:"No hay opciones disponibles",emptyMessage:"No hay opciones disponibles",onChange:l=>{var h;return v(A(d,"id",(h=l.target.value)==null?void 0:h.id))},options:_,optionLabel:"commercial_name",inputId:"owner",placeholder:"Seleccionar Tostador",className:"w-full p-2  !shadow-none !rounded-none border-[#b3b3b3] !border-t-transparent !border-l-transparent !border-r-transparent"})]}),b!=null&&b.provider?null:e.jsxs("div",{className:"w-full sm:w-[48%]",children:[e.jsx("label",{htmlFor:"owner",className:"label",children:"Al tostador"}),e.jsx(P,{filter:!0,value:r,onChange:l=>{var h;return F(A(d,"id",(h=l.target.value)==null?void 0:h.id))},options:w,optionLabel:"commercial_name",inputId:"owner",emptyFilterMessage:"No hay opciones disponibles",emptyMessage:"No hay opciones disponibles",placeholder:"Seleccionar Tostador",className:"w-full p-2  !shadow-none !rounded-none border-[#b3b3b3] !border-t-transparent !border-l-transparent !border-r-transparent"})]})]}),e.jsxs("div",{className:"mb-8",children:[e.jsx("label",{htmlFor:"name",className:"label",children:"Nombre del Producto"}),e.jsx(P,{value:S,filter:!0,onChange:l=>y(A(c==null?void 0:c.products,"id",l.target.value.id)),options:c==null?void 0:c.products,optionLabel:"commercial_name",inputId:"name",emptyFilterMessage:"No hay opciones disponibles",emptyMessage:"No hay opciones disponibles",placeholder:"Seleccionar Nombre del Producto",className:"w-full p-2  !shadow-none !rounded-none border-[#b3b3b3] !border-t-transparent !border-l-transparent !border-r-transparent"})]}),s!=null&&s.id?e.jsxs(t.Fragment,{children:[e.jsxs("div",{className:"flex-container",children:[e.jsxs("div",{className:"w-full sm:w-[48%]",children:[e.jsx("label",{htmlFor:"Code",className:"label",children:"Código"}),e.jsx(p,{value:s==null?void 0:s.code,disabled:!0,type:"text",id:"Code",placeholder:"Ingresar Código"})]}),e.jsxs("div",{className:"w-full sm:w-[48%]",children:[e.jsx("label",{htmlFor:"Region",className:"label",children:"Región"}),e.jsx(p,{value:s==null?void 0:s.region,disabled:!0,type:"text",id:"Region",placeholder:"Ingresar Región"})]})]}),e.jsxs("div",{className:"mb-8",children:[e.jsx("label",{htmlFor:"Origin",className:"label",children:"Origen"}),e.jsx(p,{value:s==null?void 0:s.origin,disabled:!0,type:"text",id:"Origin",className:"p-3 w-full border-b border-b-[#b3b3b3] placeholder:text-[#b3b3b3]",placeholder:"Ingresar Origen"})]}),e.jsxs("div",{className:"flex-container",children:[e.jsxs("div",{className:"w-full sm:w-[48%]",children:[e.jsx("label",{htmlFor:"Finca",className:"label",children:"Finca"}),e.jsx(p,{value:s==null?void 0:s.farm,disabled:!0,type:"text",id:"Finca",placeholder:"Ingresar Finca"})]}),e.jsxs("div",{className:"w-full sm:w-[48%]",children:[e.jsx("label",{htmlFor:"Nombre",className:"label",children:"Nombre Comercial"}),e.jsx(p,{value:s==null?void 0:s.commercial_name,disabled:!0,type:"text",id:"Nombre",placeholder:"Ingresar Nombre Comercial"})]})]}),e.jsxs("div",{className:"flex-container",children:[e.jsxs("div",{className:"w-full sm:w-[48%]",children:[e.jsx("label",{htmlFor:"Sca",className:"label",children:"Puntuación Sca s"}),e.jsx(p,{value:s==null?void 0:s.sca_score,disabled:!0,type:"text",id:"Sca",placeholder:"Ingresar Puntuación Sca s"})]}),e.jsxs("div",{className:"w-full sm:w-[48%]",children:[e.jsx("label",{htmlFor:"Altitud",className:"label",children:"Altitud"}),e.jsx(p,{value:s==null?void 0:s.altitude,disabled:!0,type:"text",id:"Altitud",placeholder:"Ingresar Altitud"})]})]}),e.jsxs("div",{className:"flex-container",children:[e.jsxs("div",{className:"w-full sm:w-[48%]",children:[e.jsx("label",{htmlFor:"Variedad",className:"label",children:"Variety"}),e.jsx(p,{value:s==null?void 0:s.grades,disabled:!0,type:"text",id:"Variedad",placeholder:"Ingresar Variety"})]}),e.jsxs("div",{className:"w-full sm:w-[48%]",children:[e.jsx("label",{htmlFor:"Proceso",className:"label",children:"Proceso"}),e.jsx(p,{value:s==null?void 0:s.process,disabled:!0,type:"text",id:"Proceso",placeholder:"Ingresar Proceso"})]})]}),e.jsxs("div",{className:"mb-8",children:[e.jsx("label",{htmlFor:"Description",className:"label",children:"Descripción"}),e.jsx("textarea",{rows:5,type:"text",value:s==null?void 0:s.description,disabled:!0,id:"Description",className:"p-3 w-full border-b bg-white mt-5 resize-none border-[#b3b3b3] placeholder:text-[#b3b3b3]",placeholder:"Ingresar Descripción"})]}),e.jsxs("div",{className:"w-full mb-8",children:[e.jsx("label",{htmlFor:"Presentation",className:"text-[18px] mb-2 text-[#252525] font-medium",children:"Presentación"}),e.jsx("div",{className:"border border-[#b3b3b3] p-3 sm:p-10 sm:px-20 rounded-md sm:rounded-[20px] grid grid-cols-12 gap-5",children:(m=s==null?void 0:s.presentations)==null?void 0:m.map((l,h)=>e.jsxs("div",{className:"col-span-12 sm:col-span-6 border border-[#58291E] text-center rounded-[5px] p-2",children:[l==null?void 0:l.price," Euro por ",l==null?void 0:l.weight," gm"]},h))})]}),e.jsx(K,{formik:N,dataKey:"coffeeShops",url:"/setups/coffee-shop/add-coffee",title:"Tu Tienda",pageKey:"Coffee Shops",pagePermissionKeyName:"dashboard.coffeeShops.store",options:((g=b==null?void 0:b.provider)==null?void 0:g.coffee_shops)||(r==null?void 0:r.coffee_shops),stateList:x,listOfState:C}),e.jsx("button",{onClick:u,type:"submit",className:"min-btn block !mt-10 ml-auto",children:"Enviar"})]}):null]})}function $(){return e.jsx(H,{title:"Formulario de Producto",showActions:!1,children:e.jsx(z,{})})}export{$ as default};
