import{i as A,r as p,A as k,h as V,G as j,g as l,U as y,j as E,P as F}from"./index-rFxOd0i4.js";import{P as U}from"./ProductsForm-cR8pj0WW.js";const b=()=>{var h;const m=A().search,P=new j,t=new y;p.useState({});const{user:g,setIsLoading:f}=p.useContext(k),_=m.slice(4),[x,C]=p.useState({}),i=V({initialValues:x,onSubmit:o=>{var n,s,c,u,S,w;if(!((n=o==null?void 0:o.presentations)!=null&&n.length)||!(o!=null&&o.provider_id)||!((s=o==null?void 0:o.origins)!=null&&s.length)){if(!(o!=null&&o.provider_id))return l.warning("Advertencia","El campo del tostador es necesario, por favor complÃ©telo.");if(!((c=o==null?void 0:o.origins)!=null&&c.length))return l.warning("Advertencia","Es necesario completar el campo de Origen, por favor.");if(!((u=o==null?void 0:o.presentations)!=null&&u.length))return l.warning("Advertencia","Es necesario completar el campo de presentaciones, por favor.")}else{const e={...o};return e.origins=(S=e==null?void 0:e.origins)==null?void 0:S.map(r=>(r==null?void 0:r.id)||r),e.coffeeShops=(w=e==null?void 0:e.coffeeShops)==null?void 0:w.map(r=>(r==null?void 0:r.id)||r),f(!0),t.updateProduct(_,e).finally(r=>f(!1))}}});return p.useEffect(()=>(f(!0),P.getSingleProduct(_).then(o=>{const n={commercial_name:o==null?void 0:o.commercial_name,code:o==null?void 0:o.code,trade_name:o==null?void 0:o.trade_name,region:o==null?void 0:o.region,farm:o==null?void 0:o.farm,sca_score:o==null?void 0:o.sca_score,altitude:o==null?void 0:o.altitude,process:o==null?void 0:o.process,grades:o==null?void 0:o.grades,provider_id:o==null?void 0:o.provider_id,stock:o==null?void 0:o.stock,description:o==null?void 0:o.description,presentations:o==null?void 0:o.presentations,origins:o==null?void 0:o.origins,coffeeShops:o==null?void 0:o.coffee_shops,owner_name:o==null?void 0:o.owner_name,provider:o==null?void 0:o.provider_id};i.setValues(n)}).finally(o=>f(!1)),()=>{}),[]),p.useEffect(()=>{var o,n,s,c;((n=(o=g==null?void 0:g.roles)==null?void 0:o[0])==null?void 0:n.name)==="admin"&&((s=i.values)==null?void 0:s.provider_id)!==((c=i.values)==null?void 0:c.provider)&&i.setFieldValue("coffeeShops",[])},[(h=i.values)==null?void 0:h.provider_id]),{formik:i}};function O(){const{formik:m}=b();return E.jsx(F,{title:"Formulario de Producto",showActions:!1,children:E.jsx(U,{formik:m})})}export{O as default};
