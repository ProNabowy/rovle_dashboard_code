import{j as a,r as i,A as y,L as N,F as j,o as C,G as E,P as S,D as x}from"./index-ucQm_BBe.js";import{T as _,R as F}from"./table-EIac-avB.js";import"./inputtext.esm-99rNmtVO.js";const g=new _,A=e=>a.jsxs("p",{className:`mb-1 capitalize text-[13px] font-medium ${e.status=="pending"?"text-[#C9CC3A]":e.status=="processing"?"text-[#7A3ACC]":(e==null?void 0:e.status)==="active"?"text-[#28C76F]":"text-[#FF5C34]"}`,children:[" ",(e==null?void 0:e.status)==="pending"?"Esperando pago":e==null?void 0:e.status," "]}),P=e=>{var u,c,l;return a.jsxs("p",{className:"mb-1 capitalize text-[13px] font-medium text-[#58291E]",children:[(c=(u=e==null?void 0:e.plan_size)==null?void 0:u.size)==null?void 0:c.weight,"g = ",(l=e==null?void 0:e.plan_size)==null?void 0:l.price," Euro"]})},z=e=>a.jsx(N,{to:`/products/plans/subscriptions/manage-package?id=${e.id}`,children:a.jsx(j,{icon:C,className:"text-[#45B8EA]"})}),B=[{field:"name",header:"Nombre",tamplate:g.nameBodyTemplate},{field:"created_at",header:"Fecha de inicio",tamplate:e=>g.startDateBodyTemplate(e,"start_at")},{field:"updated_at",header:"Fecha de finalizaci贸n",tamplate:e=>a.jsx("p",{className:"mb-1 capitalize text-[13px] font-medium",children:e.end_at})},{field:"status",header:"Estado",tamplate:A},{field:"name",header:"Paquete",tamplate:P},{field:"action",header:"Acci贸n",tamplate:z}],T=()=>{const[e,u]=i.useState([]),{user:c,setIsLoading:l}=i.useContext(y),d=new E,[o,p]=i.useState({}),[n,b]=i.useState({}),r=c==null?void 0:c.provider,[h,t]=i.useState([]),[f,m]=i.useState([]);return i.useEffect(()=>(l(!0),d.getRoasters().then(s=>u(s)).finally(s=>l(!1)),()=>{}),[]),i.useEffect(()=>(r!=null&&r.id?d.getPlansByProvider(r==null?void 0:r.id).then(s=>t([{name:"All",id:"all"},...s])):o!=null&&o.id&&d.getPlansByProvider(o==null?void 0:o.id).then(s=>t(s)),()=>{}),[o]),i.useEffect(()=>(l(!0),n!=null&&n.id&&((n==null?void 0:n.id)==="all"?d.getSubscriptions().then(s=>m(s)).finally(s=>l(!1)):d.getSubscriptionsByPlanId(n==null?void 0:n.id).then(s=>m(s)).finally(s=>l(!1))),()=>{}),[n]),i.useEffect(()=>(l(!0),d.getSubscriptions().then(s=>m(s)).finally(s=>l(!1)),()=>{}),[]),{selectedRosters:o,setselectedRosters:p,rosters:e,selectedPlan:n,setselectedPlan:b,subscriptionsList:f,plans:h,provider:r}};function k(){const{selectedRosters:e,setselectedRosters:u,rosters:c,selectedPlan:l,setselectedPlan:d,plans:o,provider:p,subscriptionsList:n}=T(),b=i.useRef(),r=n.map(t=>{var f,m,s;return{Nombre:t.name,Direcci贸n:t.address,Estado:t.status,Paquete:`${(m=(f=t==null?void 0:t.plan_size)==null?void 0:f.size)==null?void 0:m.weight}g = ${(s=t==null?void 0:t.plan_size)==null?void 0:s.price} Euro`}}),h=[{title:"Nombre",dataKey:"name"},{title:"Direcci贸n",dataKey:"address"},{title:"Estado",dataKey:"status"}];return a.jsxs(S,{url:"/products/plans/add-plan",addnewClassNames:"hidden",title:"Suscripciones",showActions:!0,table:b,exportedExcelList:r,list:n,exportPDFColumns:h,children:[a.jsxs("div",{className:"grid grid-cols-12 gap-5 w-full my-3 sm:my-5 px-3 sm:px-10",children:[p!=null&&p.id?null:a.jsxs("div",{className:"col-span-12 sm:col-span-6",children:[a.jsx("label",{htmlFor:"name-input",className:"mb-3 block font-medium text-[#234486]",children:"Tostador"}),a.jsx(x,{emptyFilterMessage:"No hay opciones disponibles",emptyMessage:"No hay opciones disponibles",filter:!0,value:e&&e,onChange:t=>u(t.value),options:c,optionLabel:"commercial_name",placeholder:"Seleccionar proveedor",className:"w-full p-3 !border-r-[0] !border-l-[0] !border-t-[0] !border-b !border-b-[#b3b3b3] !shadow-none !rounded-none"})]}),a.jsxs("div",{className:`${p!=null&&p.id?"col-span-12":"col-span-12 sm:col-span-6"}`,children:[a.jsx("label",{htmlFor:"name-input",className:"mb-3 block font-medium text-[#234486]",children:"Nombre del plan"}),a.jsx(x,{emptyFilterMessage:"No hay opciones disponibles",emptyMessage:"No hay opciones disponibles",filter:!0,value:l&&l,onChange:t=>d(t.value),options:Array.from(o),optionLabel:"name",placeholder:"Seleccionar Plan",className:"w-full p-3 !border-r-[0] !border-l-[0] !border-t-[0] !border-b !border-b-[#b3b3b3] !shadow-none !rounded-none"})]})]}),a.jsx(F,{columns:B,list:n,table:b})]})}export{k as default};
