import{r as x,A as I,l as L,G as S,U as D,j as a,P,t as z,I as m,F as V,v as q,D as B,p as F,w as U,x as E}from"./index-oURgFu_2.js";const A=()=>{const[e,i]=x.useState({}),n=new S,[f,p]=x.useState([]),y=new D,[b,g]=x.useState(""),{setIsLoading:r,user:s}=x.useContext(I),c=L({initialValues:s,onSubmit:l=>(r(!0),y.updateProfile(l).finally(t=>r(!1)))}),v=l=>{var t,d,o,h,u,j,w,_;return p(l),c.setFieldValue("province_id",(o=(d=(t=l==null?void 0:l[0])==null?void 0:t.provinces)==null?void 0:d[0])==null?void 0:o.id),c.setFieldValue("city_id",(_=(w=(j=(u=(h=l==null?void 0:l[0])==null?void 0:h.provinces)==null?void 0:u[0])==null?void 0:j.cities)==null?void 0:w[0])==null?void 0:_.id),null};return x.useEffect(()=>(r(!0),s!=null&&s.zip?n.getCitiesByZipCode(s==null?void 0:s.zip).then(l=>v(l)).finally(l=>r(!1)):n.getCountries().then(l=>{var t;p(l),c.setValues(s),c.setFieldValue("country_id",(t=l==null?void 0:l[0])==null?void 0:t.id)}).finally(l=>r(!1)),()=>{}),[s]),x.useEffect(()=>(i(s),s!=null&&s.image&&g(""),()=>{}),[s]),{formik:c,data:e,counteris:f,classList:b,setClassList:g,handleBlur:l=>{var t,d,o;return((d=(t=l==null?void 0:l.target)==null?void 0:t.value)==null?void 0:d.length)===5?n.getCitiesByZipCode((o=l==null?void 0:l.target)==null?void 0:o.value).then(h=>v(h)):null}}};function K(){var b,g,r,s,N,c,v,C,l,t,d,o,h;const{formik:e,data:i,counteris:n,classList:f,setClassList:p,handleBlur:y}=A();return a.jsx(P,{title:"Mi perfil",showActions:!1,children:a.jsxs("form",{onSubmit:e.handleSubmit,autoComplete:"off",className:"px-10",children:[a.jsxs("div",{className:"w-[250px] h-[250px] shadow-lg mb-20 m-auto rounded-full flex items-center justify-center relative profile-image overflow-hidden",children:[a.jsx("img",{src:typeof e.values.image=="object"?(b=e.values)!=null&&b.image?URL==null?void 0:URL.createObjectURL((g=e.values)==null?void 0:g.image):`${i==null?void 0:i.image}`:`${i==null?void 0:i.image}`,alt:"",onError:u=>(u.target.src=z,p("!w-[150px] !object-contain"),null),className:`w-full h-full object-cover rounded-full ${f}`}),a.jsxs("div",{className:"w-[250px] h-[250px] flex items-start justify-center rounded-full bg-[#45b9eae1] absolute left-0 z-20 transition bottom-[-250px] uploade-image",children:[a.jsx(m,{type:"file",accept:"image/png, image/gif, image/jpeg",onChange:u=>{e.setFieldValue("image",u.target.files[0]),p("")},id:"uploade-img",classNames:"!w-0 !h-0 appearance-none !opacity-0 !scale-0"}),a.jsx("label",{htmlFor:"uploade-img",children:a.jsx(V,{icon:q,className:"text-[40px] mt-8 -ms-3 cursor-pointer text-white"})})]})]}),a.jsxs("div",{className:"flex-container",children:[a.jsxs("div",{className:"sm:w-[48%]",children:[a.jsx("label",{htmlFor:"name",className:"label",children:"Nombre"}),a.jsx(m,{value:(r=e==null?void 0:e.values)==null?void 0:r.name,name:"name",type:"text",required:!0,onChange:e.handleChange,id:"name",placeholder:"Ingresar Nombre"})]}),a.jsxs("div",{className:"sm:w-[48%]",children:[a.jsx("label",{htmlFor:"email",className:"label",children:"Correo electrónico"}),a.jsx(m,{value:(s=e==null?void 0:e.values)==null?void 0:s.email,name:"email",type:"email",disabled:!0,required:!0,onChange:e.handleChange,id:"email",placeholder:"example@gmail.com"})]})]}),a.jsxs("div",{className:"flex-container",children:[a.jsxs("div",{className:"sm:w-[48%]",children:[a.jsx("label",{htmlFor:"address",className:"label",children:"Dirección"}),a.jsx(m,{value:(N=e==null?void 0:e.values)==null?void 0:N.address,name:"address",type:"text",required:!0,onChange:e.handleChange,id:"address",placeholder:"Ingresar Dirección"})]}),a.jsxs("div",{className:"sm:w-[48%]",children:[a.jsx("label",{htmlFor:"phone",className:"label",children:"Teléfono"}),a.jsx(m,{value:(c=e==null?void 0:e.values)==null?void 0:c.phone,name:"phone",type:"text",disabled:!!((v=i==null?void 0:i.values)!=null&&v.phone),required:!0,onChange:e.handleChange,id:"phone",placeholder:"Ingresar Teléfono"})]})]}),a.jsxs("div",{className:"flex-container",children:[a.jsxs("div",{className:"sm:w-[48%]",children:[a.jsx("label",{htmlFor:"zip",className:"label",children:"Código postal"}),a.jsx(m,{onChange:e.handleChange,onBlur:y,value:(C=e==null?void 0:e.values)==null?void 0:C.zip,name:"zip",type:"text",required:!0,min:5,max:5,maxLength:5,minLength:5,id:"zip",placeholder:"Ingresar Código postal"})]}),a.jsxs("div",{className:"sm:w-[48%]",children:[a.jsx("label",{htmlFor:"card_id",className:"label",children:"Identificación de tarjeta"}),a.jsx(m,{value:(l=e==null?void 0:e.values)==null?void 0:l.card_id,name:"card_id",type:"text",disabled:!0,required:!0,onChange:e.handleChange,id:"card_id",placeholder:"Ingresar Identificación de tarjeta"})]})]}),a.jsxs("div",{className:"flex-container",children:[a.jsxs("div",{className:"w-[48%]",children:[a.jsx("label",{className:"label block",children:"País"}),a.jsx(B,{value:F(n,"id",(t=e==null?void 0:e.values)==null?void 0:t.country_id),onChange:u=>{var j;return e.setFieldValue("country_id",(j=u.target.value)==null?void 0:j.id)},options:n,optionLabel:"name",filter:!0,placeholder:"Seleccionar nombre de país",className:"p-2 w-full !shadow-none !rounded-none !border-t-transparent !border-l-transparent !border-r-transparent"})]}),a.jsx(U,{formik:e,countries:n,country_Key:"country_id",province_Key:"province_id"})]}),a.jsxs("div",{className:"flex-container",children:[a.jsx(E,{formik:e,provinces:(o=F(n,"id",(d=e==null?void 0:e.values)==null?void 0:d.country_id))==null?void 0:o.provinces,province_Key:"province_id",city_Key:"city_id"}),a.jsxs("div",{className:"w-[48%]",children:[a.jsx("label",{htmlFor:"Permissions",className:"label block",children:"Permisos"}),a.jsx(m,{disabled:!0,value:e.values.roles&&((h=e.values.roles[0])==null?void 0:h.name),type:"text",id:"Permissions"})]})]}),a.jsx("button",{type:"submit",className:"min-btn block mt-10 ml-auto",children:"Guardar cambios"})]})})}export{K as default};
