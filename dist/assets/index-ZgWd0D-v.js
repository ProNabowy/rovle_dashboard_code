import{r as i,A as j,j as a,L as S,F as N,q as C,G as A,P as B,D as h}from"./index-oURgFu_2.js";import{T as E,R as T}from"./table-Tug-ghy4.js";import"./inputtext.esm-xRPDbi-V.js";const m=new E,F=e=>a.jsxs("p",{className:`mb-1 capitalize text-[13px] font-medium ${e.status=="pending"?"text-[#C9CC3A]":e.status=="processing"?"text-[#7A3ACC]":(e==null?void 0:e.status)==="active"?"text-[#28C76F]":"text-[#FF5C34]"}`,children:[" ",(e==null?void 0:e.status)==="pending"?"Esperando pago":e==null?void 0:e.status," "]}),P=e=>{var u,r,n;return a.jsxs("p",{className:"mb-1 capitalize text-[13px] font-medium text-[#58291E]",children:[(r=(u=e==null?void 0:e.plan_size)==null?void 0:u.size)==null?void 0:r.weight,"Kg = ",(n=e==null?void 0:e.plan_size)==null?void 0:n.price," Euro"]})},_=e=>a.jsx(S,{to:`/products/plans/subscriptions/manage-package?id=${e.id}`,children:a.jsx(N,{icon:C,className:"text-[#45B8EA]"})}),x=[{field:"name",header:"Nombre",tamplate:m.nameBodyTemplate},{field:"address",header:"Dirección",tamplate:m.addressBodyTemplate},{field:"created_at",header:"Fecha de inicio",tamplate:m.startDateBodyTemplate},{field:"updated_at",header:"Fecha de finalización",tamplate:m.lastDateBodyTemplate},{field:"status",header:"Estado",tamplate:F},{field:"name",header:"Paquete",tamplate:P},{field:"action",header:"Acción",tamplate:_}],v=()=>{const[e,u]=i.useState([]),{user:r,setIsLoading:n}=i.useContext(j),d=new A,[o,c]=i.useState({}),[t,p]=i.useState({}),l=r==null?void 0:r.provider,[g,f]=i.useState([]),[y,b]=i.useState([]);return i.useEffect(()=>(n(!0),d.getRoasters().then(s=>u(s)).finally(s=>n(!1)),()=>{}),[]),i.useEffect(()=>(l!=null&&l.id?d.getPlansByProvider(l==null?void 0:l.id).then(s=>f([{name:"All",id:"all"},...s])):o!=null&&o.id&&d.getPlansByProvider(o==null?void 0:o.id).then(s=>f(s)),()=>{}),[o]),i.useEffect(()=>(n(!0),t!=null&&t.id&&((t==null?void 0:t.id)==="all"?d.getSubscriptions().then(s=>b(s)).finally(s=>n(!1)):d.getSubscriptionsByPlanId(t==null?void 0:t.id).then(s=>b(s)).finally(s=>n(!1))),()=>{}),[t]),i.useEffect(()=>(n(!0),d.getSubscriptions().then(s=>b(s)).finally(s=>n(!1)),()=>{}),[]),{selectedRosters:o,setselectedRosters:c,rosters:e,selectedPlan:t,setselectedPlan:p,subscriptionsList:y,plans:g,provider:l}};function k(){const{selectedRosters:e,setselectedRosters:u,rosters:r,selectedPlan:n,setselectedPlan:d,plans:o,provider:c,subscriptionsList:t}=v(),p=i.useRef();return a.jsxs(B,{url:"/products/plans/add-plan",addnewClassNames:"hidden",title:"Suscripciones",showActions:!0,table:p,columns:x,list:t,saveName:"Subscriptions",children:[a.jsxs("div",{className:"grid grid-cols-12 gap-5 w-full my-5 px-10",children:[c!=null&&c.id?null:a.jsxs("div",{className:"col-span-6",children:[a.jsx("label",{htmlFor:"name-input",className:"mb-3 block font-medium text-[#234486]",children:"Tostador"}),a.jsx(h,{filter:!0,value:e&&e,onChange:l=>u(l.value),options:r,optionLabel:"commercial_name",placeholder:"Seleccionar proveedor",className:"w-full p-3 !border-r-[0] !border-l-[0] !border-t-[0] !border-b !border-b-[#b3b3b3] !shadow-none !rounded-none"})]}),a.jsxs("div",{className:`${c!=null&&c.id?"col-span-12":"col-span-6"}`,children:[a.jsx("label",{htmlFor:"name-input",className:"mb-3 block font-medium text-[#234486]",children:"Nombre del plan"}),a.jsx(h,{filter:!0,value:n&&n,onChange:l=>d(l.value),options:Array.from(o),optionLabel:"name",placeholder:"Seleccionar Plan",className:"w-full p-3 !border-r-[0] !border-l-[0] !border-t-[0] !border-b !border-b-[#b3b3b3] !shadow-none !rounded-none"})]})]}),a.jsx(T,{columns:x,list:t,table:p})]})}export{k as default};
