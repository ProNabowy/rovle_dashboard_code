import{r as p,A as _,S as C,j as e,a as P,J as g,G as E,M as T,F,N as A,P as z}from"./index-rFxOd0i4.js";import{T as B,R as k}from"./table-VNI4Whwy.js";import{D as b,T as K}from"./TableActions-rU5F1qn8.js";import"./inputtext.esm-3DeXqsqN.js";const S=c=>{const d=new C,t=new b,{setIsLoading:m}=p.useContext(_);return{handleCancelPlan:()=>{m(!0),t.cancelPlan(c==null?void 0:c.id).finally(x=>m(!1))},handleAcspetPlan:()=>{m(!0),d.acspetPlan(c==null?void 0:c.id).finally(x=>m(!1))}}};function L({visible:c,setVisible:d,row:t}){var i,x;const{handleCancelPlan:m,handleAcspetPlan:u}=S(t);return e.jsx(P,{header:`Detalles del pedido (${t==null?void 0:t.name})`,className:"w-[95vw] md:w-[700px]",headerClassName:"text-center !bg-[#58291E] !text-white",visible:c,onHide:()=>d(!1),children:e.jsxs("div",{className:"grid grid-cols-12 gap-5 mt-5",children:[e.jsxs("div",{className:"grid grid-cols-12 gap-5 mt-5 col-span-12 overflow-auto max-w-[300px] md:max-w-full",children:[e.jsxs("div",{className:"col-span-12 grid grid-cols-12 gap-5 w-[500px] sm:w-fit",children:[e.jsx("div",{className:"col-span-6",children:e.jsx("h3",{className:"text-[#252525] opacity-70 mb-[32px]",children:"Nombre del Producto"})}),e.jsx("div",{className:"col-span-2",children:e.jsx("h3",{className:"text-[#252525] opacity-70 mb-[32px]",children:"Peso"})}),e.jsx("div",{className:"col-span-2",children:e.jsx("h3",{className:"text-[#252525] opacity-70 mb-[32px]",children:"Cantidad"})}),e.jsx("div",{className:"col-span-2",children:e.jsx("h3",{className:"text-[#252525] opacity-70 mb-[32px]",children:"Precio"})})]}),(i=t==null?void 0:t.products)==null?void 0:i.map((h,r)=>{var o,f,j;return e.jsxs("div",{className:"grid grid-cols-12 gap-5 col-span-12 w-[500px] sm:w-fit",children:[e.jsx("div",{className:"col-span-4 sm:col-span-6",children:e.jsx("h5",{className:"text-[#58291E] text-[16px] font-medium line-clamp-3",children:h==null?void 0:h.product_name})}),e.jsx("div",{className:"col-span-8 sm:col-span-6",children:(j=(f=(o=t==null?void 0:t.products)==null?void 0:o[r])==null?void 0:f.items)==null?void 0:j.map((a,s)=>{var n;return e.jsxs("div",{className:"grid grid-cols-12 gap-5",children:[e.jsx("div",{className:"col-span-4 mb-1",children:e.jsx("h5",{className:"text-[#58291E] text-[16px] font-medium",children:(n=a==null?void 0:a.presentation)==null?void 0:n.weight})}),e.jsx("div",{className:"col-span-4 mb-1",children:e.jsxs("h5",{className:"text-[#58291E] text-[16px] font-medium",children:[a==null?void 0:a.units," Paquete"]})}),e.jsx("div",{className:"col-span-4 mb-1",children:e.jsxs("h5",{className:"text-[#58291E] text-[16px] font-medium",children:[g(a==null?void 0:a.total)," €"]})})]},s)})})]},r)})]}),e.jsxs("h2",{className:"col-span-12 mt-5",children:["Precio total:",e.jsxs("span",{className:"text-[#58291E] ms-3 font-medium",children:[g(t==null?void 0:t.total)," €"]})]}),e.jsxs("h2",{className:"col-span-12 ",children:["Portes:",e.jsx("span",{className:"text-[#58291E] ms-3 font-medium",children:t==null?void 0:t.shipping})]}),e.jsxs("h2",{className:"col-span-12",children:["Tienda asignada:",e.jsx("span",{className:"text-[#58291E] ms-3 font-medium",children:(x=t==null?void 0:t.coffee_shop)==null?void 0:x.name})]}),t!=null&&t.notes?e.jsxs(p.Fragment,{children:[e.jsx("h2",{className:"col-span-12 mt-3",children:"Nota:"}),e.jsx("p",{className:"p-3 border border-[#252525ac] col-span-12 rounded-[5px]",children:t==null?void 0:t.notes})]}):null,e.jsx("div",{className:"col-span-12 mt-12 max-w-[300px] sm:max-w-full overflow-auto",children:e.jsxs("div",{className:"w-[600px] sm:w-full",children:[e.jsx("h1",{className:"text-[#252525] mb-4 font-medium text-[18px]",children:"Dirección de envío"}),e.jsxs("div",{className:"grid grid-cols-12 gap-5",children:[e.jsxs("div",{className:"col-span-6 flex items-center",children:[e.jsx("h3",{className:"text-[#252525] font-medium me-4",children:"Dirección"}),e.jsx("h3",{className:"text-[#252525] font-medium",children:t==null?void 0:t.address})]}),e.jsxs("div",{className:"col-span-6 flex items-center",children:[e.jsx("h3",{className:"text-[#252525] font-medium me-4",children:"C.P."}),e.jsx("h3",{className:"text-[#252525] font-medium",children:t==null?void 0:t.zip_code})]}),e.jsxs("div",{className:"col-span-6 flex items-center",children:[e.jsx("h3",{className:"text-[#252525] font-medium me-4",children:"Nombre"}),e.jsx("h3",{className:"text-[#252525] font-medium",children:t==null?void 0:t.name})]}),e.jsxs("div",{className:"col-span-6 flex items-center",children:[e.jsx("h3",{className:"text-[#252525] font-medium me-4",children:"Email"}),e.jsx("h3",{className:"text-[#252525] font-medium",children:t==null?void 0:t.email})]}),e.jsxs("div",{className:"col-span-6 flex items-center",children:[e.jsx("h3",{className:"text-[#252525] font-medium me-4",children:"Teléfono"}),e.jsx("h3",{className:"text-[#252525] font-medium",children:t==null?void 0:t.phone})]})]})]})}),e.jsx("div",{className:"col-span-12 flex items-center justify-between flex-wrap gap-2 mt-10",children:(t==null?void 0:t.status)==="Pending"?e.jsxs(p.Fragment,{children:[e.jsx("button",{onClick:u,className:"bg-[#45B8EA] text-white py-2 sm:py-4 px-6 text-[20px] rounded-md sm:rounded-full w-full sm:w-[48%]",children:"Servir y enviar"}),e.jsx("button",{onClick:h=>d(!1),className:"bg-[#FF5C34] text-white py-2 sm:py-4 px-6 text-[20px] rounded-md sm:rounded-full w-full sm:w-[48%]",children:"No servir ni enviar por ahora"})]}):e.jsx("button",{onClick:h=>d(!1),className:"bg-[#45B8EA] text-white py-2 sm:py-4 px-6 text-[20px] rounded-md sm:rounded-full w-full sm:w-[48%] m-auto",children:"Aceptar"})})]})})}const v=new B,R=()=>{const c=new E,[d,t]=p.useState([]),{setIsLoading:m,user:u}=p.useContext(_),i=new b;p.useEffect(()=>(m(!0),c.getOrders().then(s=>{t(s==null?void 0:s.sort((n,l)=>(n==null?void 0:n.status)==="pending"&&(l==null?void 0:l.status)!=="pending"?-1:(n==null?void 0:n.status)!=="pending"&&(l==null?void 0:l.status)==="pending"?1:l==null?void 0:l.created_at.localeCompare(n==null?void 0:n.created_at)))}).finally(s=>m(!1)),()=>{}),[]);const x=s=>{var n;return e.jsx("p",{className:"mb-1 capitalize text-[13px] font-medium",children:(n=s==null?void 0:s.user)==null?void 0:n.name})},h=s=>e.jsx("p",{className:"mb-1 capitalize text-[13px] font-medium",children:s==null?void 0:s.delivery_type}),r=s=>{var y;const[n,l]=p.useState(!1),N={received:" Recibido por el cliente",pending:"pendiente",cancelled:"cancelado",sending:"Enviando",pending_payment:"Pendiente de pago"};return e.jsxs(p.Fragment,{children:[e.jsx("p",{onClick:$=>l(!0),className:`mb-1 capitalize text-[13px] cursor-pointer underline font-medium ${(s==null?void 0:s.status)=="completed"?"text-[#28C76F]":(s==null?void 0:s.status)==="canceld"?"text-[red]":"text-[#C9CC3A]"}`,children:(N==null?void 0:N[(y=s==null?void 0:s.status)==null?void 0:y.toLowerCase()])||(s==null?void 0:s.status)}),e.jsx(L,{row:s,visible:n,setVisible:l})]})},o=s=>e.jsxs("p",{className:"mb-1 capitalize text-[13px] font-medium",children:[g(s==null?void 0:s.total),"€"]}),f=s=>{var n;return e.jsx("p",{className:"mb-1 capitalize text-[13px] font-medium",children:(n=s==null?void 0:s.coffee_shop)==null?void 0:n.name})},j=s=>{var l;const n=(s==null?void 0:s.status)==="Pending"||(s==null?void 0:s.status)==="pending_payment";return T("token"),e.jsxs(p.Fragment,{children:[n?e.jsx(K,{path:`/products/plans/edit-plan?id=${s==null?void 0:s.id}`,handelDeleteFunction:i.cancelPlan,rowData:s,deleteKey:"dashboard.orders.destroy",list:d,state:t}):null,((l=s==null?void 0:s.status)==null?void 0:l.toLowerCase())==="sending"?e.jsx(F,{onClick:N=>{window.open(`https://rovle.eslamghazy.net/web/orders/${s==null?void 0:s.id}/order_onetime_code/${s==null?void 0:s.order_onetime_code}/label`,"_blank")},icon:A,className:"text-[var(--primary-color)] cursor-pointer text-[20px]"}):null]})},a=[{field:"id",header:"ID",tamplate:v.idBodyTemplate},{field:"name",header:"Nombre de usuario",tamplate:x},{field:"address",header:"Dirección",tamplate:h},{field:"stauts",header:"Estado",tamplate:r},{field:"price",header:"Precio",tamplate:o},{field:"shop_name",header:"Tienda asignada",tamplate:f},{field:"created_at",header:"Fecha de finalización",tamplate:v.startDateBodyTemplate},{field:"action",header:"Acción",tamplate:j}];return{orders:d,columns:a}};function H(){const{orders:c,columns:d}=R(),t=p.useRef(),m=c.map(i=>{var x;return{"Nombre de usuario":i.name,Dirección:i.delivery_type,Estado:i.status,"Tienda asignada":(x=i.coffee_shop)==null?void 0:x.name,"Fecha de finalización":i.created_at}}),u=[{title:"Nombre de usuario",dataKey:"name"},{title:"Dirección",dataKey:"delivery_type"},{title:"Estado",dataKey:"status"},{title:"Fecha de finalización",dataKey:"created_at"}];return e.jsx(z,{PermissionsKey:"Orders",roleKey:"dashboard.orders.store",title:"Listado de pedidos",showActions:!0,table:t,exportedExcelList:m,list:c,exportPDFColumns:u,children:e.jsx(k,{columns:d,list:c,table:t})})}export{H as default};
