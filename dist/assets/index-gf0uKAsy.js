import{r as o,A as C,G as F,j as t,F as A,k as K,a as S,D as I,g as O,S as P,P as R}from"./index-ucQm_BBe.js";import{T as B,R as E}from"./table-EIac-avB.js";import{T as L,D as k}from"./TableActions-aGRwLZuQ.js";import"./inputtext.esm-99rNmtVO.js";const h=new B,q=l=>{const[i,r]=o.useState([]),d=new F,m=new k,{setIsLoading:a,user:p}=o.useContext(C),f=new P;o.useEffect(()=>(a(!0),d.getOrigins().then(e=>r(e)).finally(e=>{a(!1)}),()=>{}),[]);const x=e=>{var c;return t.jsx("p",{className:"mb-1 capitalize text-[13px] font-medium",children:(c=e==null?void 0:e.provider)==null?void 0:c.commercial_name})},y=e=>{var g,b;const[c,u]=o.useState(!1),[n,j]=o.useState({}),v=((b=(g=p==null?void 0:p.roles)==null?void 0:g[0])==null?void 0:b.name)==="admin",N=()=>{n!=null&&n.id?f.switchOrigin({origin_from:e==null?void 0:e.id,origin_to:n==null?void 0:n.id}).then(s=>{d.getOrigins().then(T=>r(T))}).then(s=>u(!1)):O.warning("Advertencia","Debe especificar el origen por el que quiere sustituirlo")};return t.jsx(L,{path:`/origins/list/edit-origin?id=${e==null?void 0:e.id}`,handelDeleteFunction:m.deleteOrigin,rowData:e,state:r,editKey:"dashboard.origins.update",deleteKey:"dashboard.origins.destroy",PagePermissionKey:"Origins",list:i,children:v?t.jsxs(o.Fragment,{children:[t.jsx(A,{onClick:s=>u(!0),icon:K,className:"text-[20px] cursor-pointer ms-5"}),t.jsxs(S,{header:"",headerClassName:"dialog-cancel-btn",visible:c,className:"w-[95vw] sm:w-[400px]",onHide:()=>u(!1),children:[t.jsx("label",{htmlFor:"origin_to",className:"label",children:"Cambiar origen a"}),t.jsx(I,{value:n,filter:!0,onChange:s=>j(s.value),options:i==null?void 0:i.filter(s=>(s==null?void 0:s.id)!=(e==null?void 0:e.id)),optionLabel:"name",inputId:"origin_to",emptyFilterMessage:"No hay opciones disponibles",emptyMessage:"No hay opciones disponibles",required:!0,placeholder:"",className:"w-full p-2 !shadow-none  border-[#b3b3b3] "}),t.jsx("button",{onClick:N,className:"w-fit ml-auto flex items-center justify-center sm:justify-[initial] py-2 px-3 sm:px-5 lg:px-8 mt-4 rounded-md bg-[var(--primary-color)] text-white  border border-[var(--primary-color)]",children:"Enviar"})]})]}):null})},_=[{field:"id",header:"ID",tamplate:h.idBodyTemplate},{field:"name",header:"Nombre",tamplate:h.nameBodyTemplate},{field:"provider.commercial_name",header:"Introducido por",tamplate:x},{field:"created_at",header:"Fecha",tamplate:h.startDateBodyTemplate},{field:"status",header:"Acción",tamplate:y}];return{origins:i,columns:_}};function H(){const{origins:l,columns:i}=q(),r=o.useRef(),d=l.map(a=>({Nombre:a.name,"Introducido por":a.provider.commercial_name,Fecha:a.created_at})),m=[{title:"Nombre",dataKey:"name"},{title:"Introducido por",dataKey:"provider.commercial_name"},{title:"Fecha",dataKey:"created_at"}];return t.jsx(R,{url:"add-origin",title:"Todos los Orígenes",PermissionsKey:"Origins",roleKey:"dashboard.origins.store",showActions:!0,table:r,exportedExcelList:d,list:l,exportPDFColumns:m,children:t.jsx(E,{columns:i,list:l,table:r})})}export{H as default};
