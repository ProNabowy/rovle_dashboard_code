import{r as t,A as k,u as L,l as O,G as D,o as G,S as K,j as e,D as _,p as C,I as m,y as H,P as U}from"./index-UqVmnRqZ.js";const z=()=>{let[d,w]=t.useState([]);const j=new D,[P,F]=t.useState({}),s=new K,{setIsLoading:o,user:i}=t.useContext(k),[y,g]=t.useState([]),[f,N]=t.useState([]),h=L(),[p,v]=t.useState({}),[l,c]=t.useState({}),[x,A]=t.useState({}),[R,W]=t.useState({}),[a,E]=t.useState({});t.useEffect(()=>(o(!0),j.getRoasters().then(b=>w(b)).finally(b=>o(!1)),()=>{}),[]),t.useEffect(()=>{if(i!=null&&i.provider){const b=d==null?void 0:d.filter(r=>{var u;return(r==null?void 0:r.id)!==((u=i==null?void 0:i.provider)==null?void 0:u.id)}),n=d==null?void 0:d.filter(r=>{var u;return(r==null?void 0:r.id)===((u=i==null?void 0:i.provider)==null?void 0:u.id)});g(b),N(n),c(n==null?void 0:n[0])}else g(d),N(d)},[d]),t.useEffect(()=>(x!=null&&x.id&&j.getSingleProduct(x==null?void 0:x.id).then(b=>E(b)),()=>{}),[x]),t.useEffect(()=>{E({})},[p]),t.useEffect(()=>{S.setValues({commercial_name:a==null?void 0:a.commercial_name,code:a==null?void 0:a.code,description:a==null?void 0:a.description,trade_name:a==null?void 0:a.trade_name,region:a==null?void 0:a.region,farm:a==null?void 0:a.farm,sca_score:a==null?void 0:a.sca_score,altitude:a==null?void 0:a.altitude,process:a==null?void 0:a.process,grades:a==null?void 0:a.grades,provider_id:l==null?void 0:l.id,presentations:(a==null?void 0:a.presentations)||[],origins:(a==null?void 0:a.origins)||[],coffeeShops:[],parent_id:p==null?void 0:p.id})},[a]);const T=b=>{const n={...b};return n.origins=n==null?void 0:n.origins.map(r=>(r==null?void 0:r.id)||r),n.coffeeShops=n==null?void 0:n.coffeeShops.map(r=>(r==null?void 0:r.id)||r),o(!0),s.addProduct(n,h).finally(r=>o(!1))},S=O({initialValues:R}),V=G(b=>T(S.values));return t.useEffect(()=>{l&&S.setFieldValue("provider_id",l==null?void 0:l.id)},[l]),{rosters:d,formik:S,clickHandler:V,selectedProduct:x,setSelectedProduct:A,productInfo:a,selectedProvider:p,currentRoaster:l,setCurrentRoaster:c,setSelectedProvider:v,user:i,roasterFrom:y,roasterTo:f,setAddedShops:F}};function B(){var v;const{rosters:d,formik:w,clickHandler:j,selectedProduct:P,setSelectedProduct:F,productInfo:s,selectedProvider:o,currentRoaster:i,setCurrentRoaster:y,setSelectedProvider:g,roasterFrom:f,roasterTo:N,user:h,setAddedShops:p}=z();return e.jsxs("form",{onSubmit:l=>l.preventDefault(),className:"px-10 add-product",children:[e.jsxs("div",{className:"mb-8 flex items-center justify-between",children:[e.jsxs("div",{className:`${h!=null&&h.provider?"w-full":"w-[48%]"}`,children:[e.jsx("label",{htmlFor:"owner",className:"label",children:"Roaster From"}),e.jsx(_,{value:o,filter:!0,onChange:l=>{var c;return g(C(d,"id",(c=l.target.value)==null?void 0:c.id))},options:f,optionLabel:"commercial_name",inputId:"owner",placeholder:"Seleccionar Tostador",className:"w-full p-2  !shadow-none !rounded-none border-[#b3b3b3] !border-t-transparent !border-l-transparent !border-r-transparent"})]}),h!=null&&h.provider?null:e.jsxs("div",{className:"w-[48%]",children:[e.jsx("label",{htmlFor:"owner",className:"label",children:"Roaster To"}),e.jsx(_,{filter:!0,value:i,onChange:l=>{var c;return y(C(d,"id",(c=l.target.value)==null?void 0:c.id))},options:N,optionLabel:"commercial_name",inputId:"owner",placeholder:"Seleccionar Tostador",className:"w-full p-2  !shadow-none !rounded-none border-[#b3b3b3] !border-t-transparent !border-l-transparent !border-r-transparent"})]})]}),e.jsxs("div",{className:"mb-8",children:[e.jsx("label",{htmlFor:"name",className:"label",children:"Nombre del Producto"}),e.jsx(_,{value:P,filter:!0,onChange:l=>F(C(o==null?void 0:o.products,"id",l.target.value.id)),options:o==null?void 0:o.products,optionLabel:"commercial_name",inputId:"name",placeholder:"Seleccionar Nombre del Producto",className:"w-full p-2  !shadow-none !rounded-none border-[#b3b3b3] !border-t-transparent !border-l-transparent !border-r-transparent"})]}),s!=null&&s.id?e.jsxs(t.Fragment,{children:[e.jsxs("div",{className:"flex-container",children:[e.jsxs("div",{className:"w-[48%]",children:[e.jsx("label",{htmlFor:"Code",className:"label",children:"Código"}),e.jsx(m,{value:s==null?void 0:s.code,disabled:!0,type:"text",id:"Code",placeholder:"Ingresar Código"})]}),e.jsxs("div",{className:"w-[48%]",children:[e.jsx("label",{htmlFor:"Region",className:"label",children:"Region"}),e.jsx(m,{value:s==null?void 0:s.region,disabled:!0,type:"text",id:"Region",placeholder:"Ingresar Region"})]})]}),e.jsxs("div",{className:"mb-8",children:[e.jsx("label",{htmlFor:"Origin",className:"label",children:"Origen"}),e.jsx(m,{value:s==null?void 0:s.origin,disabled:!0,type:"text",id:"Origin",className:"p-3 w-full border-b border-b-[#b3b3b3] placeholder:text-[#b3b3b3]",placeholder:"Ingresar Origen"})]}),e.jsxs("div",{className:"flex-container",children:[e.jsxs("div",{className:"w-[48%]",children:[e.jsx("label",{htmlFor:"Finca",className:"label",children:"Finca"}),e.jsx(m,{value:s==null?void 0:s.farm,disabled:!0,type:"text",id:"Finca",placeholder:"Ingresar Finca"})]}),e.jsxs("div",{className:"w-[48%]",children:[e.jsx("label",{htmlFor:"Nombre",className:"label",children:"Nombre Comercial"}),e.jsx(m,{value:s==null?void 0:s.commercial_name,disabled:!0,type:"text",id:"Nombre",placeholder:"Ingresar Nombre Comercial"})]})]}),e.jsxs("div",{className:"flex-container",children:[e.jsxs("div",{className:"w-[48%]",children:[e.jsx("label",{htmlFor:"Sca",className:"label",children:"Puntuación Sca s"}),e.jsx(m,{value:s==null?void 0:s.sca_score,disabled:!0,type:"text",id:"Sca",placeholder:"Ingresar Puntuación Sca s"})]}),e.jsxs("div",{className:"w-[48%]",children:[e.jsx("label",{htmlFor:"Altitud",className:"label",children:"Altitud"}),e.jsx(m,{value:s==null?void 0:s.altitude,disabled:!0,type:"text",id:"Altitud",placeholder:"Ingresar Altitud"})]})]}),e.jsxs("div",{className:"flex-container",children:[e.jsxs("div",{className:"w-[48%]",children:[e.jsx("label",{htmlFor:"Variedad",className:"label",children:"Variety"}),e.jsx(m,{value:s==null?void 0:s.grades,disabled:!0,type:"text",id:"Variedad",placeholder:"Ingresar Variety"})]}),e.jsxs("div",{className:"w-[48%]",children:[e.jsx("label",{htmlFor:"Proceso",className:"label",children:"Proceso"}),e.jsx(m,{value:s==null?void 0:s.process,disabled:!0,type:"text",id:"Proceso",placeholder:"Ingresar Proceso"})]})]}),e.jsxs("div",{className:"mb-8",children:[e.jsx("label",{htmlFor:"Description",className:"label",children:"Descripción"}),e.jsx("textarea",{rows:5,type:"text",value:s==null?void 0:s.description,disabled:!0,id:"Description",className:"p-3 w-full border-b bg-white mt-5 resize-none border-[#b3b3b3] placeholder:text-[#b3b3b3]",placeholder:"Ingresar Descripción"})]}),e.jsxs("div",{className:"w-full mb-8",children:[e.jsx("label",{htmlFor:"Presentation",className:"text-[18px] mb-2 text-[#252525] font-medium",children:"Presentación"}),e.jsx("div",{className:"border border-[b3b3b3] p-10 px-20 rounded-[20px] grid grid-cols-12 gap-5",children:(v=s==null?void 0:s.presentations)==null?void 0:v.map((l,c)=>e.jsxs("div",{className:"col-span-6 border border-[#58291E] text-center rounded-[5px] p-2",children:[l==null?void 0:l.price," Euro por ",l==null?void 0:l.weight," gm"]},c))})]}),e.jsx(H,{formik:w,dataKey:"coffeeShops",url:"/setups/coffee-shop/add-coffee",title:"Tu Tienda",pageKey:"Coffee Shops",pagePermissionKeyName:"dashboard.coffeeShops.store",options:i==null?void 0:i.coffee_shops,stateList:p}),e.jsx("button",{onClick:j,type:"submit",className:"min-btn block !mt-10 ml-auto",children:"Enviar"})]}):null]})}function q(){return e.jsx(U,{title:"Formulario de Producto",showActions:!1,children:e.jsx(B,{})})}export{q as default};
